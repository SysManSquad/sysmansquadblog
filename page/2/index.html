<!doctype html><html lang=en-us>
<head>
<meta name=generator content="Hugo 0.92.0">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=keyword content="ConfigMgr Microsoft Intune Windows WinAdmins">
<meta name=viewport content="width=device-width">
<meta name=description content="A community blog and subsidiary of WinAdmins.io">
<link rel="shortcut icon" href=/img/favicon.ico>
<title>Systems Management Squad-SysManSquad | Systems Management Squad</title>
<link rel=canonical href=/>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=https://blog.sysmansquad.com/css/custom.css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://blog.sysmansquad.com/js/jquery.slicknav.js></script>
<script src=https://blog.sysmansquad.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://blog.sysmansquad.com/js/custom.js></script>
<link rel=alternate type=application/rss+xml href=/index.xml title="Systems Management Squad">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZR1RSQYX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-XXZR1RSQYX',{anonymize_ip:!1})}</script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.sysmansquad.com/83">
<meta name=twitter:title content="Systems Management Squad">
<meta name=twitter:description content="A community blog and subsidiary of WinAdmins.io">
</head>
<body class="home blog">
<div id=asd-container>
<div id=top-bar>
<div class=container>
<div id=nav-wrapper>
<ul class=menu id=menu-top-menu>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/>Home</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/about/>
<span>About</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=https://github.com/SysManSquad>
<span>GitHub</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/jointhesquad/>
<span>Join the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/meetthesquad/>
<span>Meet the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=#>
<span>MORE></span>
</a>
<ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/contact/>Contact</a>
</li>
</ul>
</li>
</ul>
</div>
<div id=top-search>
<a href=# class=search><i class="fa fa-search"></i></a>
<div class=show-search>
<form role=search method=get action=https://www.google.com/search id=searchform>
<input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://blog.sysmansquad.com>
<button type=submit value=Search>
</form>
</div>
</div>
<div class=menu id=menu-mobile></div>
</div>
</div>
<header id=header class=noslider>
<div class=container>
<div id=logo>
<h1><a href=https://blog.sysmansquad.com><img src=/img/SysManSquad-HorizontalColor-Logo.png alt="Systems Management Squad"></a></h1>
</div>
</div>
</header>
<div class=container>
<div id=content>
<div id=main>
<article class=list-item>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/04/27/updated-modern-driver-bios-management-with-cmg-support/>Updated Modern Driver/BIOS Management with CMG Support</a>
</h2>
</div>
<div class=post-entry>
<p>
&lt;li class="uagb-toc__list"> [Improvements to Invoke-GetPackageIDFromAdminService](#improvements-to-invoke-getpackageidfromadminservice)&lt;ul class="uagb-toc__list"> &lt;li class="uagb-toc__list"> [1) New parameters and ParameterSets](#1-new-parameters-and-parametersets)&lt;li class="uagb-toc__list"> &lt;li class="uagb-toc__list"> [2) Verify, Install and Import the MSAL.PS module](#2-verify-install-and-import-the-msalps-module)&lt;li class="uagb-toc__list"> &lt;li class="uagb-toc__list"> [3) Querying the AdminService](#3-querying-the-adminservice) &lt;/li>&lt;/ul> &lt;/li>&lt;/ul> &lt;/li>&lt;/ul> &lt;/li> &lt;li class="uagb-toc__list"> [Improvements to the task sequence](#improvements-to-the-task-sequence)&lt;ul class="uagb-toc__list"> &lt;li class="uagb-toc__list"> [1) Is the client on Internet?](#1-is-the-client-on-internet)&lt;li class="uagb-toc__list"> &lt;li class="uagb-toc__list"> [2) Additional Parameters for Internet clients](#2-additional-parameters-for-internet-clients)&lt;li class="uagb-toc__list"> &lt;li class="uagb-toc__list"> [3) Running the script with the right parameters](#3-running-the-script-with-the-right-parameters) &lt;/li>&lt;/ul> &lt;/li>&lt;/ul> &lt;/li>&lt;/ul> &lt;/li>&lt;/ul> &lt;/li> &lt;li class="uagb-toc__list"> [The end result](#the-end-result)&lt;li class="uagb-toc__list"> [How do I set this up in my environment?
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/02/22/create-a-new-winpe-boot-image/>Create a new WinPE boot image</a>
</h2>
</div>
<div class=post-entry>
<p>
Introduction &lt;p> In this post I'll show you how you can create a new boot image in ConfigMgr. &lt;/p> &lt;p> There's plenty of good content out there already on this, but I was interested to write this because I didn't see many PowerShell examples out there until I came across Michael Niehaus' post on [Build your own Windows PE image](https://oofhours.com/2021/01/17/build-your-own-windows-pe-image/). A fantastic post, highly recommend reading it. Michael provided a useful script at the end of this post in a .
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/02/17/keeping-up-with-distribution-points/>Keeping Up with Distribution Points</a>
</h2>
</div>
<div class=post-entry>
<p>
Distribution Points are great, but they can often be a huge annoyance. Getting content distributed is one thing, but then making sure it STAYS distributed, and old things are getting cleaned up, and making sure all the content hashes are correct, etc. It’s easy to feel like you’re constantly drowning in a sea of DP warnings and errors.
Luckily, there’s some simple things we can do to take this burden away.
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/02/16/multilingual-windows-10-20h2-osd-with-configmgr/>Multilingual Windows 10 20H2 OSD with ConfigMgr</a>
</h2>
</div>
<div class=post-entry>
<p>
&lt;p> In this post I'm going to share with you a task sequence for ConfigMgr / SCCM / MEMCM / MECM / MCM (this is just getting silly now) that localises Windows 10 to a language other than the default language of the OS install media. &lt;/p> &lt;p> This is a follow up from my previous post [Language Packs, Language Experience Packs, Language Interface Packs… what?!](https://sysmansquad.com/2020/06/08/language-packs-language-experience-packs-language-interface-packs-what/) &lt;/p> &lt;p> In that post I broke down the necessary bits in order to understand how to localise a Windows system.
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=post-img>
<a href=https://blog.sysmansquad.com/2021/02/13/create-a-small-discord-py-bot-to-deploy-a-server/>
<img width=520 height=400 src=https://blog.sysmansquad.com/2021/02/13/create-a-small-discord-py-bot-to-deploy-a-server/eagle-46636_1280.png>
</a>
</div>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/02/13/create-a-small-discord-py-bot-to-deploy-a-server/>Create a small discord.py bot to deploy a server</a>
</h2>
</div>
<div class=post-entry>
<p>
I volunteer to help run Southwest CCDC every year, and had a need to deploy all of the communication infrastructure in a hurry. With Covid Times™ upon us, we needed to move a competition that usually has at least one round in person to all-virtual. Discord was the obvious choice for how to do that successfully - it is targeted to communities of people, and has moderation tools. My discord server needed to have a few things:
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=post-img>
<a href=https://blog.sysmansquad.com/2021/02/09/access-public-github-repo-feeds-in-power-automate/>
<img width=520 height=400 src=https://blog.sysmansquad.com/2021/02/09/access-public-github-repo-feeds-in-power-automate/Github-RSS-Flow-4.png>
</a>
</div>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/02/09/access-public-github-repo-feeds-in-power-automate/>Access Public GitHub Repo Feeds in Power Automate</a>
</h2>
</div>
<div class=post-entry>
<p>
<p>Have you ever wanted to get a simple notification when there is a new Release for your favorite PowerShell Module or other Public Repo on GitHub? In this post we&rsquo;ll talk about how you can use Power Automate to watch for new releases and trigger events on these and send out Teams messages, Emails, or even Kick off an Azure Function or similar automation.</p>
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=post-img>
<a href=https://blog.sysmansquad.com/2021/01/26/trigger-teams-installer-for-user-after-machine-wide-installer/>
<img width=520 height=400 src=https://blog.sysmansquad.com/2021/01/26/trigger-teams-installer-for-user-after-machine-wide-installer/Teams-NotFound.png>
</a>
</div>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/01/26/trigger-teams-installer-for-user-after-machine-wide-installer/>Trigger Teams Installer for User After Machine Wide Installer</a>
</h2>
</div>
<div class=post-entry>
<p>
Outline The Problem: Teams Machine Wide Installer finishes… Then… Nothing? What&rsquo;s Going On Here? The Solution: Improve the User Experience Just Give Me The Script - I&rsquo;ll Figure Out the Rest The Problem: Teams Machine Wide Installer finishes&mldr; Then&mldr; Nothing? Have you or a loved one ever deployed Microsoft Teams in an enterprise environment? Did the users complain? Did project management complain? Management? You?
I&rsquo;m sure someone was not happy about the overall user experience.
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=post-img>
<a href=https://blog.sysmansquad.com/2021/01/18/collecting-logs-with-log-analytics-for-intune-devices/>
<img width=520 height=400 src=https://blog.sysmansquad.com/2021/01/18/collecting-logs-with-log-analytics-for-intune-devices/image-1.png>
</a>
</div>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/01/18/collecting-logs-with-log-analytics-for-intune-devices/>Collecting Logs with Log Analytics for Intune devices</a>
</h2>
</div>
<div class=post-entry>
<p>
Why do I need logs? The purpose of this guide is to configure the collection of Logs in an Intune environment. By default the log analytics you enable in Intune does not give you much information beyond auditing basic things. With this approach we can record any desired log for all of our machines. There is a companion video for this setup https://youtu.be/Uw3GjMnSXbI.
Enabling Log Analytics Navigate to endpoint.microsoft.com Select Reports Select Diagnostic Settings Select Add Diagnostic setting Select all options under Log Select Send to Log Analytics workspace Select a Log Analytics workspace You can archive to a storage account to keep data longer Now that we have the log analytics workspace configured we can configure the Microsoft Monitoring Agent (MMA)
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=post-img>
<a href=https://blog.sysmansquad.com/2021/01/05/finding-azure-virtual-machines-in-configuration-manager/>
<img width=520 height=400 src=https://blog.sysmansquad.com/2021/01/05/finding-azure-virtual-machines-in-configuration-manager/image-14.png>
</a>
</div>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2021/01/05/finding-azure-virtual-machines-in-configuration-manager/>Finding Azure Virtual Machines in Configuration Manager</a>
</h2>
</div>
<div class=post-entry>
<p>
A request came in from my System Admin group to push certain policies only to VMs hosted in Azure. Currently, they had a naming convention being used (well, supposed to be used) to simply prefix the hostname with AZ-, but they came across a couple Domain Controllers that hadn&rsquo;t installed Updates in 7+ months, and of course the names didn&rsquo;t follow the accepted standard.
Azure Metadata Service &lt;p> Officially, the Azure Metadata Service is: &lt;/p> `[.
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<article class=list-item>
<div class=list-content>
<div class=post-header>
<h2 class=post-title>
<a href=https://blog.sysmansquad.com/2020/12/30/automating-changing-out-of-business-hours-responses/>Automating Outside of Business Hours Responses</a>
</h2>
</div>
<div class=post-entry>
<p>
<p>Have you ever had customers emailing in outside of hours? In this post we will setup some scripted automatic maintenance of Auto-Reply responses on a user account.</p>
<p>We considered several possibilities but the customer did not have an Azure Subscription yet, we ended up using <strong>PowerShell</strong>, <strong>Microsoft Graph</strong>, <strong>App Authentication</strong>, and a <strong>Scheduled Task</strong>.</p>
</p>
</div>
<div class=list-meta>
<span class=post-date>
</span>
</div>
</div>
</article>
<div class=pagination>
<div class=newer>
<a href=/>← Newer Posts</a>
</div>
<div class=older>
<a href=/page/3/>Older Posts →</a>
</div>
</div>
</div>
<aside id=sidebar>
<div class="widget widget_search">
<form role=search method=get action=https://www.google.com/search id=searchform>
<input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://blog.sysmansquad.com>
<button type=submit value=Search>
</form>
</div>
<div>
<div class="widget widget_recent_entries">
<h4 class=widget-title>Squad Posts</h4>
<ul>
<li><a href=/2021/11/11/microsoft-teams-cache-a-burden-to-us-all/ target=_blank>Microsoft Teams Cache, a burden to us all</a></li>
<li><a href=/2021/10/18/get-rid-of-the-continue-connecting-prompt-for-your-policy-configured-wifi-networks/ target=_blank>Get rid of the “Continue connecting?” prompt for your policy-configured wifi networks</a></li>
<li><a href=/2021/10/08/removing-the-built-in-teams-app-in-windows-11-with-intune/ target=_blank>Removing The Built-in Teams App in Windows 11 with Intune</a></li>
<li><a href=/2021/08/30/installing-the-configuration-manager-client-during-autopilot/ target=_blank>Installing The Configuration Manager Client During Autopilot</a></li>
<li><a href=/2021/07/12/use-azure-policy-to-configure-boot-diagnostics-settings/ target=_blank>Use Azure Policy to configure Boot Diagnostics Settings</a></li>
</ul>
</div>
</aside>
</div>
</div>
<footer id=footer>
<div class=container>
<div id=footer-copyright>
<p class=copyright>&copy; 2022 WinAdmins - https://blog.sysmansquad.com - Systems Management Squad</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>