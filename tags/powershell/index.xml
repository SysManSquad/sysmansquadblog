<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PowerShell on Systems Management Squad</title><link>https://sysmansquad.com/tags/powershell/</link><description>Recent content in PowerShell on Systems Management Squad</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 09 Aug 2022 13:59:21 +0000</lastBuildDate><atom:link href="https://sysmansquad.com/tags/powershell/index.xml" rel="self" type="application/rss+xml"/><item><title>Who Is Logged On, From The System Context</title><link>https://sysmansquad.com/2022/08/09/which-user-is-logged-in-when-running-as-system/</link><pubDate>Tue, 09 Aug 2022 13:59:21 +0000</pubDate><guid>https://sysmansquad.com/2022/08/09/which-user-is-logged-in-when-running-as-system/</guid><description>Intro Have you ever deployed a script that needs to be executed in the system context, but you also need to work with something that is currently running in the user context?
Obviously you could just loop through all the user profiles on the system, but thats not always a good idea.
Lo and behold, you can simply see who is the owner of the explorer.exe process and use that, Obviously this will not work if no one is logged on.</description></item><item><title>Where is the report’s data??</title><link>https://sysmansquad.com/2021/05/15/where-is-the-reports-data/</link><pubDate>Sun, 16 May 2021 03:21:09 +0000</pubDate><guid>https://sysmansquad.com/2021/05/15/where-is-the-reports-data/</guid><description>Have you ever looked at a report on a Portal Page and wanted to know just WHERE the data just came from?
Well you can - and finding the information can be so easy. Read on below to see how.
Introduction Take for example this report on a Proactive Remediation. I used one of the built in Proactive Remediations for the example, but it could easily be one of our other Proactive Remediation posts, like Dynamic Outlook Signatures, Building VPN Connections, or Repairing Folder permissions.</description></item><item><title>Working around NPS limitations for AADJ Windows devices</title><link>https://sysmansquad.com/2021/04/27/working-around-nps-limitations-for-aadj-windows-devices/</link><pubDate>Wed, 28 Apr 2021 03:10:47 +0000</pubDate><guid>https://sysmansquad.com/2021/04/27/working-around-nps-limitations-for-aadj-windows-devices/</guid><description>⚠️ UPDATE (2023-03-11) ⚠️ Due to changes introduced by Microsoft in KB5014754 and being enforced on November 14, 2023, the name mapping method used in the scripts below will no longer work, and authentication will fail at that time. Thankfully, commenter Anders Hannus has pointed out a policy module named TameMyCerts for Microsoft Active Directory Certificate Services (AD CS). This policy module, used in conjunction with the below scripts, will let us work around Microsoft&amp;rsquo;s changes and give us the added benefit of no longer needing name mappings that are insecure.</description></item><item><title>Access Public GitHub Repo Feeds in Power Automate</title><link>https://sysmansquad.com/2021/02/09/access-public-github-repo-feeds-in-power-automate/</link><pubDate>Tue, 09 Feb 2021 13:26:41 +0000</pubDate><guid>https://sysmansquad.com/2021/02/09/access-public-github-repo-feeds-in-power-automate/</guid><description>Have you ever wanted to get a simple notification when there is a new Release for your favorite PowerShell Module or other Public Repo on GitHub? In this post we&amp;rsquo;ll talk about how you can use Power Automate to watch for new releases and trigger events on these and send out Teams messages, Emails, or even Kick off an Azure Function or similar automation.
Introduction In my previous post, we did some automation with client-side scripts and Microsoft Graph to update Outlook Auto-Responses on a schedule.</description></item><item><title>Mapping Network Drives on Intune Devices</title><link>https://sysmansquad.com/2020/12/16/mapping-network-drives-on-intune-devices/</link><pubDate>Wed, 16 Dec 2020 19:04:49 +0000</pubDate><guid>https://sysmansquad.com/2020/12/16/mapping-network-drives-on-intune-devices/</guid><description>This guide is part of a video series companion guide on setting up mapped drives on Intune devices - you can watch the video here S02E18 How to Map Network Drives on Microsoft Intune Devices - (I.T)! This is rather simple but I will be adding some useful bits of code for people who do not have an always on VPN solution for all those Work From Home scenarios.
Creating the script Before we get started let me explain how this process works.</description></item><item><title>Find Microsoft Accounts on Company Domains</title><link>https://sysmansquad.com/2020/11/23/find-microsoft-accounts/</link><pubDate>Mon, 23 Nov 2020 15:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/11/23/find-microsoft-accounts/</guid><description>The other day I was helping someone over in the WinAdmins Discord. Their users kept getting confused about what their passwords were, and it was causing a lot of HelpDesk tickets. Let&amp;rsquo;s find out what users have Microsoft accounts on the company domain so we can help move those accounts elsewhere to streamline the user experience.
Update on Prevention: Microsoft has introduced some changes that at least seem to prevent NEW Microsoft Accounts on Company Domains.</description></item><item><title>Teams Channel Notification when OSD Fails</title><link>https://sysmansquad.com/2020/04/22/teams-channel-notification-when-osd-fails/</link><pubDate>Wed, 22 Apr 2020 13:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/04/22/teams-channel-notification-when-osd-fails/</guid><description>How would you like this lovely notification appearing within MS Teams every time a build failed? Better than getting a helpdesk ticket or not finding out at all.
Well, now you can!
Removed broken screenshot - editor
Step 1 - Configure Teams You need to make sure your O365 Administrator has enabled Incoming webhooks connectors in your O365 Tenant.
Open Teams. Select a channel, or create a new channel specific for these notifications (This is best practice so normal channels are not spammed) Click the &amp;hellip; Next to the channel name and choose Connectors Removed broken screenshot - editor</description></item><item><title>Inventory Deprovisioned Windows 10 Apps</title><link>https://sysmansquad.com/2020/03/11/inventory-deprovisioned-windows-10-apps/</link><pubDate>Wed, 11 Mar 2020 14:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/03/11/inventory-deprovisioned-windows-10-apps/</guid><description>In my previous post I&amp;rsquo;ve shown that we can revert the deprovisioning of Windows 10 apps. This is awesome news for anyone that has removed the Windows Store. I have been unable to find any other way of restoring the Windows Store once it has been deprovisioned, so this is an awesome time saver. Instead of reimaging devices that do not have the store we can simply &amp;lsquo;reprovision&amp;rsquo; the store, and perform a feature update!</description></item><item><title>Reprovision Windows 10 Apps… Wait, What?</title><link>https://sysmansquad.com/2021/01/06/reprovision-windows-10-apps-wait-what/</link><pubDate>Mon, 06 Jan 2020 13:54:48 +0000</pubDate><guid>https://sysmansquad.com/2021/01/06/reprovision-windows-10-apps-wait-what/</guid><description>Remember when we all complained that Microsoft &amp;ldquo;wasn&amp;rsquo;t respecting our app removals!&amp;rdquo; and they were all reinstalled during every feature update? Pepperidge farm remembers. Well, Microsoft was kind enough to hear our collective complaints, and take action on them. That is an awesome quality that we are seeing from the product teams at Microsoft.
Starting in Windows 10 1803, deprovisioned apps will NOT be reinstalled during a feature update. No more Solitaire returning from the dead every time we try to &amp;ldquo;Get current and stay current.</description></item></channel></rss>