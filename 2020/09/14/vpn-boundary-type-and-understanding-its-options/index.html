<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=keyword content="ConfigMgr Microsoft Intune Windows WinAdmins">
<meta name=viewport content="width=device-width">
<meta name=description content="A community blog and subsidiary of WinAdmins.io">
<link rel="shortcut icon" href=/img/favicon.ico>
<title>VPN Boundary Type and Understanding Its Options-SysManSquad | Systems Management Squad</title>
<link rel=canonical href=/2020/09/14/vpn-boundary-type-and-understanding-its-options/>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=https://blog.sysmansquad.com/css/custom.css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://blog.sysmansquad.com/js/jquery.slicknav.js></script>
<script src=https://blog.sysmansquad.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://blog.sysmansquad.com/js/custom.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZR1RSQYX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-XXZR1RSQYX',{anonymize_ip:!1})}</script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.sysmansquad.com/83">
<meta name=twitter:title content="VPN Boundary Type and Understanding Its Options">
<meta name=twitter:description content="Like many, I was very excited that the new Configuration Manager 2006 release included a huge improvement for remote devices by adding a new VPN Boundary type.
&ldquo;Finally! I don&rsquo;t have to constantly bug my Network Engineers as to which IP pools are being used for which VPN appliances.&rdquo;
Create A New Boundary In the Admin Console, navigate to the Administration Node and open up Hierarchy Configuration and right-click on Boundaries    Select the new VPN option in the Type drop-down    Exploring the VPN Type Options Types Defined From the Define boundaries - Configuration Manager | Microsoft Docs, these are the type options:">
</head>
<body class="home blog">
<div id=asd-container>
<div id=top-bar>
<div class=container>
<div id=nav-wrapper>
<ul class=menu id=menu-top-menu>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/>Home</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/about/>
<span>About</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=https://github.com/SysManSquad>
<span>GitHub</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/jointhesquad/>
<span>Join the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/meetthesquad/>
<span>Meet the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=#>
<span>MORE></span>
</a>
<ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/contact/>Contact</a>
</li>
</ul>
</li>
</ul>
</div>
<div id=top-search>
<a href=# class=search><i class="fa fa-search"></i></a>
<div class=show-search>
<form role=search method=get action=https://www.google.com/search id=searchform>
<input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://blog.sysmansquad.com>
<button type=submit value=Search>
</form>
</div>
</div>
<div class=menu id=menu-mobile></div>
</div>
</div>
<header id=header class=noslider>
<div class=container>
<div id=logo>
<h1><a href=https://blog.sysmansquad.com><img src=/img/SysManSquad-HorizontalColor-Logo.png alt="Systems Management Squad"></a></h1>
</div>
</div>
</header>
<div class=container>
<div id=content>
<div id=main class=fullwidth>
<article class="post type-post status-publish format-standard has-post-thumbnail hentry">
<div class=post-header>
<h1>VPN Boundary Type and Understanding Its Options</h1>
<span class=post-date>September 14, 2020</span>
</div>
<div class=post-entry>
<p>Like many, I was <em>very</em> excited that the new <a href=https://docs.microsoft.com/en-us/mem/configmgr/core/plan-design/changes/whats-new-in-version-2006#vpn-boundary-type>Configuration Manager 2006</a> release included a huge improvement for remote devices by adding a new <a href=https://docs.microsoft.com/en-us/mem/configmgr/core/servers/deploy/configure/boundaries#vpn>VPN Boundary type</a>.<br>
&ldquo;Finally! I don&rsquo;t have to constantly bug my Network Engineers as to which IP pools are being used for which VPN appliances.&rdquo;</p>
<h2 id=create-a-new-boundary>Create A New Boundary</h2>
<p>In the Admin Console, navigate to the Administration Node and open up Hierarchy Configuration and right-click on Boundaries</p>
<p><div class=image>
<figure>
<a href=image-2.png target=_blank>
<img src=image-2.png alt>
</a>
</figure>
</div> </p>
<p>Select the new VPN option in the Type drop-down</p>
<p><div class=image>
<figure>
<a href=image-3.png target=_blank>
<img src=image-3.png alt>
</a>
</figure>
</div> </p>
<h2 id=exploring-the-vpn-type-options>Exploring the VPN Type Options</h2>
<h4 id=types-defined>Types Defined</h4>
<p>From the <a href=https://docs.microsoft.com/en-us/mem/configmgr/core/servers/deploy/configure/boundaries#vpn>Define boundaries - Configuration Manager | Microsoft Docs</a>, these are the type options:</p>
<ul>
<li><strong>Auto detect VPN</strong>: Configuration Manager detects any VPN solution that uses the point-to-point tunneling protocol (PPTP). If it doesn&rsquo;t detect your VPN, use one of the other options. The boundary value in the console list will be Auto:On.</li>
<li><strong>Connection name</strong>: Specify the name of the VPN connection on the device. It&rsquo;s the name of the network adapter in Windows for the VPN connection. Configuration Manager matches the first 250 characters of the string, but doesn&rsquo;t support wildcard characters or partial strings. The boundary value in the console list will be Name:, where  is the connection name that you specify.<br>
For example, you run the ipconfig command on the device, and one of the sections starts with: PPP adapter ContosoVPN:. Use the string ContosoVPN as the <strong>Connection name</strong>. It displays in the list as Name:CONTOSOVPN.</li>
<li><strong>Connection description</strong>: Specify the description of the VPN connection. Configuration Manager matches the first 243 characters of the string, but doesn&rsquo;t support wildcard characters or partial strings. The boundary value in the console list will be Description:, where  is the connection description that you specify.<br>
For example, you run the ipconfig /all command on the device, and one of the connections includes the following line: Description . . . . . . . . . . . : ContosoMainVPN. Use the string ContosoMainVPN as the <strong>Connection description</strong>. It displays in the list as Description:CONTOSOMAINVPN.</li>
</ul>
<h4 id=finding-the-best-fitfigure-classwp-block-table>Finding the Best Fit</h4>
<pre><code>&lt;td&gt;
  &lt;strong&gt;Decision&lt;/strong&gt;
&lt;/td&gt;

&lt;td class=&quot;has-text-align-center&quot; data-align=&quot;center&quot;&gt;
  &lt;strong&gt;Selected&lt;/strong&gt;
&lt;/td&gt;
</code></pre>
<pre><code>&lt;td&gt;
  We don't use PPTP
&lt;/td&gt;

&lt;td class=&quot;has-text-align-center&quot; data-align=&quot;center&quot;&gt;
&lt;/td&gt;
</code></pre>
<pre><code>&lt;td&gt;
  This won't work as our VPN client doesn't create a &quot;section&quot; with a title like &lt;code&gt;PPP adapter ContosoVPN&lt;/code&gt;
&lt;/td&gt;

&lt;td class=&quot;has-text-align-center&quot; data-align=&quot;center&quot;&gt;
&lt;/td&gt;
</code></pre>
<pre><code>&lt;td&gt;
  Just need to copy the Description value from ipconfig/all and we're done!
&lt;/td&gt;

&lt;td class=&quot;has-text-align-center&quot; data-align=&quot;center&quot;&gt;
  X
&lt;/td&gt;
</code></pre>
<h2 id=to-test-i-followed-the-instructions>To test, I followed the instructions</h2>
<p>On a machine connected to our VPN solution, Palo Alto Global Protect, I capture the specified information from the documentation.</p>
<p><a href="https://www.sysmansquad.com/?attachment_id=1747"><div class=image>
<figure>
<a href=2020-09-13_9-33-39.png target=_blank>
<img src=2020-09-13_9-33-39.png alt>
</a>
</figure>
</div></a></p>
<p>Next, I went back to the Admin Console and my open Create Boundary window, and pasted the description from <code>ipconfig /all</code> into the Connection Description field.</p>
<p><div class=image>
<figure>
<a href=image-4.png target=_blank>
<img src=image-4.png alt>
</a>
</figure>
</div> </p>
<p>Then I added the new Boundary to my VPN Boundary Group.</p>
<h2 id=test-results>Test Results</h2>
<p>What happened next confused me. After forcing a few clients to update their Machine Policy, I saw VPN-connected devices drop <em>out</em> of the VPN Boundary Group that I added my newly-created Boundary to. I double-checked my own machine:</p>
<p>The output revealed that my machine was no longer in my VPN Boundary Group, and instead was merely in the fallback Default Boundary Group.<br>
But WHY?</p>
<p>Taking to Twitter, I posted a message&mldr;</p>
<pre><code>  [August 27, 2020](https://twitter.com/robdotyork/status/1298788226606329858?ref_src=twsrc%5Etfw)
&lt;/blockquote&gt;
</code></pre>
<p>and none other than Rob York responded, inadvertently leading me to answer my own question</p>
<pre><code>  [August 27, 2020](https://twitter.com/robdotyork/status/1298807830867111938?ref_src=twsrc%5Etfw)
&lt;/blockquote&gt;
</code></pre>
<h2 id=my-mistakes-were-two-fold>My mistakes were two-fold:</h2>
<ol>
<li>Some of you may have noticed above that the output from <code>ipconfig/all</code> in my image did not match what I typed into the <code>Connection Description</code> field in the Boundary properties window.
<ol>
<li>The <a href=https://docs.microsoft.com/en-us/mem/configmgr/core/servers/deploy/configure/boundaries#vpn>docs</a> clearly state that the string must be exact and that wildcards are not supported (see red text in type definitions above).</li>
</ol>
</li>
<li>The second mistake I made was attempting to have forethought while also assuming I knew what I was doing.
<ol>
<li>When I opened the Admin Console, I thought, &ldquo;Hey, there&rsquo;s a chance that there could be slight variations in the Description value among the 1k+ devices I have. Let&rsquo;s check the database first.&rdquo;</li>
<li>I ran this query and got the results shown in my Tweet above</li>
</ol>
</li>
</ol>
<p>FROM v_GS_NETWORK_ADAPTER
WHERE Description0 LIKE &lsquo;PANGP Virtual Ethernet Adapter%&rsquo;
ORDER BY Description0```</p>
<p>I assumed that the <code>Description</code> field populated in <code>win32_networkadapter</code> matched the <code>Description</code> field from <code>ipconfig/all</code>, but you already know that wasn&rsquo;t the case.</p>
<p><div class=image>
<figure>
<a href=Snag_2984151.png target=_blank>
<img src=Snag_2984151.png alt="Description Compare">
</a>
</figure>
</div> </p>
<h2 id=the-solution>The Solution</h2>
<p>Once I re-read Rob York&rsquo;s response, I realized I was looking at the wrong property and ninja-edited my SQL query:</p>
<blockquote>
<p><em>&ldquo;But what you saw is expected&rdquo;</em></p>
<p>Rob york</p>
</blockquote>
<p>FROM v_GS_NETWORK_ADAPTER
WHERE Name0 LIKE &lsquo;PANGP Virtual Ethernet Adapter%&rsquo;
ORDER BY Description0```</p>
<p>This gave me more results and made me realize I needed a Boundary for each of these adapter Descriptions. Er&mldr; <em>Name0</em></p>
<p><div class=image>
<figure>
<a href=Snag_29cce99.png target=_blank>
<img src=Snag_29cce99.png alt="SQL adapter">
</a>
</figure>
</div> </p>
<p>And now my VPN Boundary Group looks like this and devices are where they need to be.</p>
<p><div class=image>
<figure>
<a href=Snag_2a0b39b.png target=_blank>
<img src=Snag_2a0b39b.png alt=BG>
</a>
</figure>
</div> </p>
</div>
<comments id=comments>
<script src=https://utteranc.es/client.js repo=SysManSquad/sysmansquadblog issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script>
</comments>
</article>
</div>
</div>
</div>
<footer id=footer>
<div class=container>
<div id=footer-copyright>
<p class=copyright>&copy; 2021 WinAdmins - https://blog.sysmansquad.com - Systems Management Squad</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>