<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=keyword content="ConfigMgr Microsoft Intune Windows WinAdmins"><meta name=viewport content="width=device-width"><meta name=description content="A community blog and subsidiary of WinAdmins.io"><link rel="shortcut icon" href=/img/favicon.ico><title>Collect Client Logs – The Fast Channel Way-SysManSquad | Systems Management Squad</title><link rel=canonical href=/2020/04/08/collect-client-logs-the-fast-channel-way/><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://sysmansquad.com/css/custom.css><script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://sysmansquad.com/js/jquery.slicknav.js></script>
<script src=https://sysmansquad.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://sysmansquad.com/js/custom.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZR1RSQYX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XXZR1RSQYX",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sysmansquad.com/83"><meta name=twitter:title content="Collect Client Logs – The Fast Channel Way"><meta name=twitter:description content="What&rsquo;s New? Starting in MEMCM 2002 there is an incredible new tool in the Client Notification tool bag. Client log collection!
This is a vital addition to the console. At first glance I thought&mldr;
But then the features full value was realized!
Collecting Logs Over CMG Scenario: Increasing remote workforce, no VPN, but that nifty CMG thing is in place. What does that imply? There is no SMB access to the client."></head><body class="home blog"><div id=asd-container><div id=top-bar><div class=container><div id=nav-wrapper><ul class=menu id=menu-top-menu><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/>Home</a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/about/><span>About</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=https://github.com/SysManSquad><span>GitHub</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/jointhesquad/><span>Join the Squad</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/meetthesquad/><span>Meet the Squad</span></a></li><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=#><span>MORE></span></a><ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home"><a href=/contact/>Contact</a></li></ul></li></ul></div><div id=top-search><a href=# class=search><i class="fa fa-search"></i></a><div class=show-search><form role=search method=get action=https://www.google.com/search id=searchform><input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://sysmansquad.com>
<button type=submit value=Search class=searchbutton></form></div></div><div class=menu id=menu-mobile></div></div></div><header id=header class=noslider><div class=container><div id=logo><h1><a href=https://sysmansquad.com><img src=/img/SysManSquad-HorizontalColor-Logo.png alt="Systems Management Squad"></a></h1></div></div></header><div class=container><div id=content><div id=main class=fullwidth><article class="post type-post status-publish format-standard has-post-thumbnail hentry"><div class=post-header><h1>Collect Client Logs – The Fast Channel Way</h1><p class=p-meta><span class=post-author><a href=/authors/cody>Cody Mathis</a> /</span>
<span class=post-date>April 8, 2020</span>
<span class=post-categories>/ Endpoint Management</span>
<span class=post-categories>/ MECM/MEMCM/SCCM</span></p></div><div class=post-entry><h2 id=whats-new>What&rsquo;s New?</h2><p>Starting in <a href=https://docs.microsoft.com/configmgr/core/plan-design/changes/whats-new-in-version-2002>MEMCM 2002</a> there is an incredible new tool in the Client Notification tool bag. <a href=https://docs.microsoft.com/configmgr/core/plan-design/changes/whats-new-in-version-2002#client-log-collection>Client log collection!</a></p><p>This is a vital addition to the console. At first glance I thought&mldr;</p><p><div class=image><figure><a href=Bender-Neat.gif target=_blank><img src=Bender-Neat.gif alt=screenshot></a></figure></div></p><p>But then the features full value was realized!</p><h2 id=collecting-logs-over-cmg>Collecting Logs Over CMG</h2><p><strong>Scenario:</strong> Increasing remote workforce, no VPN, but that nifty CMG thing is in place. What does that imply? There is no SMB access to the client. WinRM is not going to work either. I kindly asked the user to zip up the c:\windows\ccm\logs directory, but instead I received a picture from their cellphone of the desktop with Software Center open.</p><p><strong>Solution:</strong></p><p><div class=image><figure><a href=image.png target=_blank><img src=image.png alt=screenshot></a></figure></div></p><h2 id=i-did-it-i-clicked-the-button>I Did It!!! I Clicked the Button!</h2><p>But where the heck are the log files?? How do I even know that anything happened. WHEN is it going to happen?</p><p>Thankfully this tool uses the &lsquo;Fast Channel&rsquo; within MEMCM. The action can expect to be started very quickly. Whether anything at all is even happening can be verified by checking the &lsquo;Diagnostics.log&rsquo; on the client. Doesn&rsquo;t help us in the &lsquo;remote&rsquo; scenario, but it is good to see in the proof of concept.</p><p><a href=image-1.png><div class=image><figure><a href=image-1-1024x158.png target=_blank><img src=image-1-1024x158.png alt=screenshot></a></figure></div></a></p><p>What sticks out here is the MP_SinvCollFileEndpoint! Software Inventory??</p><p>But, I&rsquo;m sure we want to see this from the server side right? At least a glimpse into what is going on! Let&rsquo;s follow this to the Management Point. We can see the MP_SinvCollFile.log on the MP.</p><p><div class=image><figure><a href=image-7.png target=_blank><img src=image-7.png alt=screenshot></a></figure></div></p><p>It looks like the Software Inventory components of MEMCM have been reworked a bit, and are being leveraged to collect log files!</p><p><a href=image-2.png><div class=image><figure><a href=image-2-1024x354.png target=_blank><img src=image-2-1024x354.png alt=screenshot></a></figure></div></a></p><p>The bgbmgr.log, and bgbserver.log files, located on the Site Server will provide some insight into what is going on as well. Feel free to enable verbose logging to really dig in, but at a base level we do see our request being processed.</p><p>The log files reveal that our request has started processing. A push request was processed, meaning the server put a note out there that this specific client has some work to do. From there, we end up with a file in our bgb.box inbox after the client does the work, and sends that note of &lsquo;work complete&rsquo; up through an MP/CMG. The task was initiated, the client acted on it, and we have an inbox file. Worth noting, this happened in under a minute!</p><h2 id=when>When?!?</h2><p>Soon enough&mldr; Real time in MEMCM time is like, a few minutes or less. Go grab a beer, or a smoothie. We work from home now folks. In the lab environment, this was pretty fast. Hopefully, in production it is NOT this fast. You shouldn&rsquo;t go drink a beer in under a minute.</p><h2 id=where>Where?!?</h2><p>Resource Explorer! It has an entire new section, labeled &lsquo;Diagnostic Files.&rsquo;</p><p>Pop open Resource Explorer on the client which logs were requested from, and there are some new options outlined below.</p><p><div class=image><figure><a href=image-3.png target=_blank><img src=image-3.png alt=screenshot></a></figure></div></p><p>To expand on the &lsquo;where&rsquo; question, we can see the &lsquo;File Path&rsquo; column stating this data is being stored in the &lsquo;systemprofile&rsquo; which is typically on the C: drive. That can&rsquo;t be where they really store all this!!</p><p><a href=image-4.png><div class=image><figure><a href=image-4-1024x64.png target=_blank><img src=image-4-1024x64.png alt=screenshot></a></figure></div></a></p><p>It isn&rsquo;t&mldr; This is a temporary location, where the files will be accessible for you to interact with. The ACTUAL location of the file, as stored on the Site Server can be found by click the &lsquo;View File&rsquo; context menu option.</p><p><div class=image><figure><a href=image-9.png target=_blank><img src=image-9.png alt=screenshot></a></figure></div></p><p>What the &lsquo;View File&rsquo; option reveals, is that these files are actually stored in your Inboxes on your Site Server. Specifically, &lt;ConfigMgrInstallPath>\inboxes\sinv.box\FileCol&amp;lt;ResourceID>. Each resource ID that has collected files will show up here as a subfolder, and you&rsquo;ll find zip files for each diagnostic file collection request.</p><h2 id=ahhh-thats-going-to-fill-up-the-site-server>Ahhh!!! That&rsquo;s Going To Fill Up The Site Server!</h2><p>Yes&mldr; it absolutely could if left unchecked. This new feature prompts us to review a maintenance task that has likely been paid little mind if you aren&rsquo;t using Software Inventory in your environment, with file collection. This defaults to <strong>90 days!!!</strong> I can imagine 90 days of diagnostic log files, even when zipped, could get a bit large. You may want to review this maintenance task, and the disk space available on the drive that contains your inboxes.</p><p><div class=image><figure><a href=image-8.png target=_blank><img src=image-8.png alt=screenshot></a></figure></div></p><p>Thanks to <a href=https://twitter.com/KrisTiteca>@KrisTiteca</a> for pointing out that the files are store in the inbox!!</p><h2 id=viewing-the-log-files>Viewing The Log Files</h2><p>What all this is for though is to actually <em>view</em> the log files. There is a context menu option for &lsquo;Open Support Center&rsquo; if you right click any of these new &lsquo;Diagnostic Files.&rsquo;</p><p><div class=image><figure><a href=image-11.png target=_blank><img src=image-11.png alt=screenshot></a></figure></div></p><p>From there, the sky is the limit. You now have the entire CCM\Logs directory from a remote computer that potentially never touched your domain. You can ignore the weird text message with a pixelated picture of the users screen.</p><p><div class=image><figure><a href=image-6.png target=_blank><img src=image-6.png alt=screenshot></a></figure></div></p><p>Go support those people working from home!!!</p><p><a href=https://twitter.com/CodyMathis123>@CodyMathis123</a></p><img src=/authors/cody/avatar.png alt="Photo of Cody Mathis"><br><strong>Cody Mathis</strong>
<em>Contributor</em><div><a href=https://twitter.com/CodyMathis123><img src=/img/social/twitter.png></a>
<a href=https://www.linkedin.com/in/cody-mathis-22a717136><img src=/img/social/linkedin.png></a></div><p>Cody has 10 years of ConfigMgr, PowerShell, and automation experience focusing on streamlining processes</p><hr></div><div class=post-share><div class="post-share-box share-comments"></div></div><comments id=comments><script src=https://utteranc.es/client.js repo=SysManSquad/sysmansquadblog issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script></comments></article></div></div></div><footer id=footer><div class=container><div id=footer-copyright><p class=copyright>&copy; 2022 WinAdmins - https://sysmansquad.com - Systems Management Squad</a></p></div></div></footer></div></body></html>