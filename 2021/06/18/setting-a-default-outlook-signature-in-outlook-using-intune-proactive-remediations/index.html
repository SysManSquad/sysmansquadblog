<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=keyword content="ConfigMgr Microsoft Intune Windows WinAdmins">
<meta name=viewport content="width=device-width">
<meta name=description content="A community blog and subsidiary of WinAdmins.io">
<link rel="shortcut icon" href=/img/favicon.ico>
<title>Setting A Default Outlook Signature in Outlook using Intune Proactive Remediations-SysManSquad | Systems Management Squad</title>
<link rel=canonical href=/2021/06/18/setting-a-default-outlook-signature-in-outlook-using-intune-proactive-remediations/>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=https://blog.sysmansquad.com/css/custom.css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://blog.sysmansquad.com/js/jquery.slicknav.js></script>
<script src=https://blog.sysmansquad.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://blog.sysmansquad.com/js/custom.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZR1RSQYX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-XXZR1RSQYX',{anonymize_ip:!1})}</script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.sysmansquad.com/83">
<meta name=twitter:title content="Setting A Default Outlook Signature in Outlook using Intune Proactive Remediations">
<meta name=twitter:description content="So you have already figured out how to dynamically generated outlook signatures, but now you want to make sure that people actually use them. but without preventing the use of other signatures your users might have.
Well it just so happens that I have a solution for you!    No default signature has been setTo do all this, we create a new Proactive Remediation in Intune.
Add the detection and remediations scripts from below, and set it to run as the user.">
</head>
<body class="home blog">
<div id=asd-container>
<div id=top-bar>
<div class=container>
<div id=nav-wrapper>
<ul class=menu id=menu-top-menu>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/>Home</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/about/>
<span>About</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=https://github.com/SysManSquad>
<span>GitHub</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/jointhesquad/>
<span>Join the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/meetthesquad/>
<span>Meet the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=#>
<span>MORE></span>
</a>
<ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/contact/>Contact</a>
</li>
</ul>
</li>
</ul>
</div>
<div id=top-search>
<a href=# class=search><i class="fa fa-search"></i></a>
<div class=show-search>
<form role=search method=get action=https://www.google.com/search id=searchform>
<input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://blog.sysmansquad.com>
<button type=submit value=Search>
</form>
</div>
</div>
<div class=menu id=menu-mobile></div>
</div>
</div>
<header id=header class=noslider>
<div class=container>
<div id=logo>
<h1><a href=https://blog.sysmansquad.com><img src=/img/SysManSquad-HorizontalColor-Logo.png alt="Systems Management Squad"></a></h1>
</div>
</div>
</header>
<div class=container>
<div id=content>
<div id=main class=fullwidth>
<article class="post type-post status-publish format-standard has-post-thumbnail hentry">
<div class=post-header>
<h1>Setting A Default Outlook Signature in Outlook using Intune Proactive Remediations</h1>
<span class=post-date>June 18, 2021</span>
</div>
<div class=post-entry>
<p>So you have already figured out <a href=https://sysmansquad.com/2020/07/08/dynamic-outlook-email-signature-using-with-intune-endpoint-analytics-proactive-remediations/>how to dynamically generated outlook signatures</a>, but now you want to make sure that people actually use them. but without preventing the use of other signatures your users might have.</p>
<p>Well it just so happens that I have a solution for you!</p>
<p><div class=image>
<figure>
<a href=before.png target=_blank>
<img src=before.png alt>
</a>
</figure>
</div> No default signature has been set</p>
<p>To do all this, we create a new <a href=https://sysmansquad.com/2020/07/07/intune-autopilot-proactive-remediation/>Proactive Remediation in Intune</a>.</p>
<p>Add the detection and remediations scripts from below, and set it to run as the user.</p>
<p><div class=image>
<figure>
<a href=vmconnect_68MRJGl48P.png target=_blank>
<img src=vmconnect_68MRJGl48P.png alt>
</a>
</figure>
</div> </p>
<p>This solution takes care of picking the default outlook profile. but keep in mind that this has only been tested on Office 365/microsoft 365 apps for business. so I have no idea if it works on the legacy versions.</p>
<p>You only need to specify the name of the signature file on line 4 in both the detection and remediation scripts, which are case sensitive.</p>
<h3 id=this-is-case-sensitive>this is case sensitive!</h3>
<p>$DefaultSignatureName = &ldquo;fancy-signature&rdquo;</p>
<h1 id=in-my-environment-the-upn-and-email-is-always-the-same-and-we-use-this-to-make-sure-we-are-using-the-correct-path>in my environment the UPN and email is always the same. and we use this to make sure we are using the correct path</h1>
<p>$upn = whoami /upn</p>
<h1 id=find-the-default-profile-name-used-by-outlook>find the default profile name used by outlook</h1>
<p>$profilename = Get-ItemProperty -Path &ldquo;hkcu:\SOFTWARE\Microsoft\Office\16.0\Outlook&rdquo; -Name DefaultProfile | Select-Object -ExpandProperty DefaultProfile</p>
<h1 id=alaska-is-the-only-state-whose-name-is-on-one-row-on-a-keyboard>Alaska is the only state whose name is on one row on a keyboard.</h1>
<h1 id=grabs-all-the-data-we-need-to-detect-the-signature-configuration-from-the-default-outlook-profile>grabs all the data we need to detect the signature configuration from the default outlook profile</h1>
<p>$profilepath = Get-ItemProperty -Path &ldquo;hkcu:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles$profilename\9375CFF0413111d3B88A00104B2A6676*&rdquo; | Where-Object { $_.&ldquo;Account name&rdquo; -eq $upn }</p>
<p>try {</p>
<pre><code># check if the key even exists
if ( $profilepath.&quot;New Signature&quot; -eq $null) {

    Write-Host &quot;new signature key does not exist&quot;
    exit 1
}
</code></pre>
<h1 id=checks-if-the-new-signature-key-equals-the-signature-name-we-have-specified>checks if the New Signature key equals the signature name we have specified</h1>
<pre><code>if ( ($profilepath.&quot;New Signature&quot;) -ne $DefaultSignatureName ) {

    Write-Host &quot;new signature key is set to $($profilepath.&quot;New Signature&quot;) when it should be $DefaultSignatureName&quot;
    exit 1
}
</code></pre>
<p>}
catch {
$errMsg = $_.Exception.Message
Write-Host $errMsg
exit 1
}</p>
<p>You need to change the name of the signature on line 4.</p>
<h1 id=in-my-environment-the-upn-and-email-is-always-the-same-and-we-use-this-to-make-sure-we-are-using-the-correct-path-1>in my environment the UPN and email is always the same. and we use this to make sure we are using the correct path</h1>
<p>$upn = whoami /upn</p>
<p>try {</p>
<pre><code>if ( (Test-Path -Path &quot;hkcu:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\&quot;) -eq $false ) {

    write-host &quot;no outlook profile found, remediation is not possible&quot;
    exit 1
}
</code></pre>
<h1 id=find-the-default-profile-name-used-by-outlook-1>find the default profile name used by outlook</h1>
<pre><code>$profilename = Get-ItemProperty -Path &quot;hkcu:\SOFTWARE\Microsoft\Office\16.0\Outlook&quot; -Name DefaultProfile | Select-Object -ExpandProperty DefaultProfile
</code></pre>
<h1 id=grabs-all-the-data-we-need-to-detect-the-signature-configuration-from-the-default-outlook-profile-1>grabs all the data we need to detect the signature configuration from the default outlook profile</h1>
<pre><code>$profilepath = Get-ItemProperty -Path &quot;hkcu:\SOFTWARE\Microsoft\Office\16.0\Outlook\Profiles\$profilename\9375CFF0413111d3B88A00104B2A6676\*&quot; | Where-Object { $_.&quot;Account name&quot; -eq $upn } | Select-Object -ExpandProperty pspath
# did you know adam gross is an amazing singer?
# and finally we create/set the &quot;new signature&quot; key
New-ItemProperty -Path $profilepath -Name &quot;New Signature&quot; -Value $DefaultSignatureName -Force -ErrorAction stop

Write-Host &quot;New Signature set to $DefaultSignatureName&quot;
exit 0 
</code></pre>
<p>}</p>
<p>catch {
$errMsg = $_.Exception.Message
Write-Host $errMsg
exit 1
}</p>
<p>There is one caveat, this change will only take effect when outlook is restarted.</p>
<p><div class=image>
<figure>
<a href=after.png target=_blank>
<img src=after.png alt>
</a>
</figure>
</div> Neato burrito, check it out!</p>
</div>
<comments id=comments>
<script src=https://utteranc.es/client.js repo=SysManSquad/sysmansquadblog issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script>
</comments>
</article>
</div>
</div>
</div>
<footer id=footer>
<div class=container>
<div id=footer-copyright>
<p class=copyright>&copy; 2021 WinAdmins - https://blog.sysmansquad.com - Systems Management Squad</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>