<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=keyword content="ConfigMgr Microsoft Intune Windows WinAdmins">
<meta name=viewport content="width=device-width">
<meta name=description content="A community blog and subsidiary of WinAdmins.io">
<link rel="shortcut icon" href=/img/favicon.ico>
<title>Removing The Built-in Teams App in Windows 11 with Intune-SysManSquad | Systems Management Squad</title>
<link rel=canonical href=/2021/10/08/removing-the-built-in-teams-app-in-windows-11-with-intune/>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=https://blog.sysmansquad.com/css/custom.css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://blog.sysmansquad.com/js/jquery.slicknav.js></script>
<script src=https://blog.sysmansquad.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://blog.sysmansquad.com/js/custom.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZR1RSQYX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-XXZR1RSQYX',{anonymize_ip:!1})}</script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.sysmansquad.com/83">
<meta name=twitter:title content="Removing The Built-in Teams App in Windows 11 with Intune">
<meta name=twitter:description content="Intro So you&rsquo;ve started rolling out Windows 11 to your endpoints, and your users got confused and upset over the consumer teams apps that is installed? Understandably you wish to do something about this.    (╯°□°）╯︵ ┻━┻No worries mate, Intune Proactive Remediations to the rescue!
The Solution The code below fixes two things.
It removes the chat by writing the registry key that disables it    the TaskbarMn DWORD controls thisThen it simply uninstalls the appx package for the consumer teams app, note that this has no effect on the regular teams app.">
</head>
<body class="home blog">
<div id=asd-container>
<div id=top-bar>
<div class=container>
<div id=nav-wrapper>
<ul class=menu id=menu-top-menu>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/>Home</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/about/>
<span>About</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=https://github.com/SysManSquad>
<span>GitHub</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/jointhesquad/>
<span>Join the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/meetthesquad/>
<span>Meet the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=#>
<span>MORE></span>
</a>
<ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/contact/>Contact</a>
</li>
</ul>
</li>
</ul>
</div>
<div id=top-search>
<a href=# class=search><i class="fa fa-search"></i></a>
<div class=show-search>
<form role=search method=get action=https://www.google.com/search id=searchform>
<input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://blog.sysmansquad.com>
<button type=submit value=Search>
</form>
</div>
</div>
<div class=menu id=menu-mobile></div>
</div>
</div>
<header id=header class=noslider>
<div class=container>
<div id=logo>
<h1><a href=https://blog.sysmansquad.com><img src=/img/SysManSquad-HorizontalColor-Logo.png alt="Systems Management Squad"></a></h1>
</div>
</div>
</header>
<div class=container>
<div id=content>
<div id=main class=fullwidth>
<article class="post type-post status-publish format-standard has-post-thumbnail hentry">
<div class=post-header>
<h1>Removing The Built-in Teams App in Windows 11 with Intune</h1>
<span class=post-date>October 8, 2021</span>
</div>
<div class=post-entry>
<h2 id=intro>Intro</h2>
<p>So you&rsquo;ve started rolling out Windows 11 to your endpoints, and your users got confused and upset over the consumer teams apps that is installed? Understandably you wish to do something about this.</p>
<p><div class=image>
<figure>
<a href=vmconnect_HKVrTs61hf.png target=_blank>
<img src=vmconnect_HKVrTs61hf.png alt>
</a>
</figure>
</div> (╯°□°）╯︵ ┻━┻</p>
<p>No worries mate, Intune Proactive Remediations to the rescue!</p>
<h2 id=the-solution>The Solution</h2>
<p>The code below fixes two things.</p>
<p>It removes the chat by writing the registry key that disables it</p>
<p><div class=image>
<figure>
<a href=vmconnect_GJk3LXz1EF.png target=_blank>
<img src=vmconnect_GJk3LXz1EF.png alt>
</a>
</figure>
</div> the TaskbarMn DWORD controls this</p>
<p>Then it simply uninstalls the appx package for the consumer teams app, note that this has no effect on the regular teams app. The two are completely different.</p>
<h2 id=code>Code</h2>
<p>Pretty simple stuff,</p>
<pre><code># check the reg key for the taskbar teams app icon
# Reg2CI (c) 2021 by Roger Zander
if ( (Get-ItemPropertyValue -LiteralPath 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarMn' -ErrorAction Stop ) -eq 0 ) { $RegCompliance = $true }
else { $RegCompliance = $false } 

# check if the teams app is installed
if ($null -eq (Get-AppxPackage -Name MicrosoftTeams) ) { $AppCompliance = $true }
else { $AppCompliance = $false }

# evaluate the compliance
if ($RegCompliance -and $AppCompliance -eq $true) {

    Write-Host &quot;Success, app/reg removed&quot;
    exit 0
}
else {
    Write-Host &quot;Failure, app/reg detected&quot;
    exit 1
}
</code></pre>
<p>}
catch {
$errMsg = _.Exception.Message
Write-Host $errMsg
exit 1
}</p>
<p>Here is the remediation code, parts of it were made using the <a href=https://reg2ps.azurewebsites.net/>reg2ps website</a> which i highly recommend.</p>
<p>try {</p>
<pre><code># remove the taskbar icon
# Reg2CI (c) 2021 by Roger Zander
if ((Test-Path -LiteralPath &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot;) -ne $true) {
    New-Item &quot;HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; -Force -ErrorAction Stop 
}
New-ItemProperty -LiteralPath 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'TaskbarMn' -Value 0 -PropertyType DWord -Force -ErrorAction Stop


# uninstall the teams consumer app
Get-AppxPackage -Name MicrosoftTeams | Remove-AppxPackage -ErrorAction stop

# as nothing errored out, we will report success
Write-Host &quot;Success, regkey set and app uninstalled&quot;
exit 0
</code></pre>
<p>}</p>
<p>catch {
$errMsg = _.Exception.Message
Write-Host $errMsg
exit 1
}</p>
<h2 id=setting-it-up>Setting it up</h2>
<p>Go to the <a href=https://endpoint.microsoft.com/#blade/Microsoft_Intune_Enrollment/UXAnalyticsMenu/proactiveRemediations>Proactive Remediations blade</a> in the Intune admin portal, create a new PR and add the detection and remediation scripts, configure the PR to run in user context and 64bit, and deploy accordingly.</p>
<p><div class=image>
<figure>
<a href=WindowsSandboxClient_EZVCQZGC8M.png target=_blank>
<img src=WindowsSandboxClient_EZVCQZGC8M.png alt>
</a>
</figure>
</div> </p>
<p>Once the Remediation has run on the targeted endpoints, your users will be happier and slightly less confused.</p>
<p><div class=image>
<figure>
<a href=j4sLKefuYe.png target=_blank>
<img src=j4sLKefuYe.png alt>
</a>
</figure>
</div> ┳━┳ ノ( ゜-゜ノ)</p>
</div>
<div class=post-share>
<div class="post-share-box share-comments">
hello
</div>
</div>
<div class=post-author>
</div>
<comments id=comments>
<script src=https://utteranc.es/client.js repo=SysManSquad/sysmansquadblog issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script>
</comments>
</article>
</div>
</div>
</div>
<footer id=footer>
<div class=container>
<div id=footer-copyright>
<p class=copyright>&copy; 2021 WinAdmins - https://blog.sysmansquad.com - Systems Management Squad</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>