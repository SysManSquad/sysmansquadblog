<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=keyword content="ConfigMgr Microsoft Intune Windows WinAdmins">
<meta name=viewport content="width=device-width">
<meta name=description content="A community blog and subsidiary of WinAdmins.io">
<link rel="shortcut icon" href=/img/favicon.ico>
<title>Where is the report’s data??-SysManSquad | Systems Management Squad</title>
<link rel=canonical href=/2021/05/15/where-is-the-reports-data/>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=https://blog.sysmansquad.com/css/custom.css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://blog.sysmansquad.com/js/jquery.slicknav.js></script>
<script src=https://blog.sysmansquad.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://blog.sysmansquad.com/js/custom.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZR1RSQYX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-XXZR1RSQYX',{anonymize_ip:!1})}</script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.sysmansquad.com/83">
<meta name=twitter:title content="Where is the report’s data??">
<meta name=twitter:description content="Have you ever looked at a report on a Portal Page and wanted to know just WHERE the data just came from?
Well you can - and finding the information can be so easy. Read on below to see how.">
</head>
<body class="home blog">
<div id=asd-container>
<div id=top-bar>
<div class=container>
<div id=nav-wrapper>
<ul class=menu id=menu-top-menu>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/>Home</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/about/>
<span>About</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=https://github.com/SysManSquad>
<span>GitHub</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/jointhesquad/>
<span>Join the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/meetthesquad/>
<span>Meet the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=#>
<span>MORE></span>
</a>
<ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/contact/>Contact</a>
</li>
</ul>
</li>
</ul>
</div>
<div id=top-search>
<a href=# class=search><i class="fa fa-search"></i></a>
<div class=show-search>
<form role=search method=get action=https://www.google.com/search id=searchform>
<input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://blog.sysmansquad.com>
<button type=submit value=Search>
</form>
</div>
</div>
<div class=menu id=menu-mobile></div>
</div>
</div>
<header id=header class=noslider>
<div class=container>
<div id=logo>
<h1><a href=https://blog.sysmansquad.com><img src=/img/SysManSquad-HorizontalColor-Logo.png alt="Systems Management Squad"></a></h1>
</div>
</div>
</header>
<div class=container>
<div id=content>
<div id=main class=fullwidth>
<article class="post type-post status-publish format-standard has-post-thumbnail hentry">
<div class=post-header>
<h1>Where is the report’s data??</h1>
<span class=post-date>May 16, 2021</span>
</div>
<div class=post-entry>
<p>Have you ever looked at a report on a Portal Page and wanted to know just <em><strong>WHERE</strong></em> the data just came from?</p>
<p>Well you can - and finding the information can be so easy. Read on below to see how.</p>
<pre><code>&lt;span class=&quot;uag-toc__collapsible-wrap&quot;&gt; &lt;svg xmlns=&quot;https://www.w3.org/2000/svg&quot; viewBox= &quot;0 0 320 512&quot;&gt;&lt;path d=&quot;M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z&quot;&gt;&lt;/path&gt;&lt;/svg&gt; &lt;/span&gt;
</code></pre>
<pre><code>                      &lt;div class=&quot;wp-block-group alignwide&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2&gt;
                            Introduction
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            Take for example this report on a [Proactive Remediation](https://endpoint.microsoft.com/#blade/Microsoft_Intune_Enrollment/UXAnalyticsMenu/proactiveRemediations). I used one of the built in Proactive Remediations for the example, but it could easily be one of our other [Proactive Remediation](https://sysmansquad.com/category/endpoint-management/proactive-remediation/) posts, like [Dynamic Outlook Signatures](https://sysmansquad.com/2020/07/08/dynamic-outlook-email-signature-using-with-intune-endpoint-analytics-proactive-remediations/), [Building VPN Connections](https://sysmansquad.com/2020/07/07/intune-autopilot-proactive-remediation/), or [Repairing Folder permissions](https://sysmansquad.com/2020/07/27/setting-acl-using-intune-endpoint-analytics-proactive-remediations/).
                          &lt;/p&gt;&lt;figure class=&quot;wp-block-image alignwide&quot;&gt;
                          
                          ![](https://i.imgur.com/Zffu5T5.png)&lt;/figure&gt; 
                          
                          &lt;p&gt;
                            This data is generally all exposed by Graph or a similar Microsoft API, it is just a matter of finding the right endpoints.
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2 id=&quot;api-endpoint-hell&quot;&gt;
                            So, wandering API Endpoint Hell?
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            You could absolutely go through the docs pages for [Microsoft Graph](https://docs.microsoft.com/en-us/graph/) or other APIs and find the [Get deviceHealthScriptRunSummary](https://docs.microsoft.com/graph/api/intune-devices-devicehealthscriptrunsummary-get?view=graph-rest-beta) - but the Portal is already fetching the information somehow - a lot of times you can just look at how the Portal fetches the information, and do the same thing yourself.
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            Instead or blindly wandering the several levels of API Docs, let's use some of the tools built-in to Modern Browsers like Edge and Google Chrome to observe how the Web Portal fetches the information internally.
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group alignwide&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2 id=&quot;watching-the-portal-work&quot;&gt;
                            Watching how the Portal works
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            First up, let's open the [Proactive Remediations area](https://endpoint.microsoft.com/#blade/Microsoft_Intune_Enrollment/UXAnalyticsMenu/proactiveRemediations) and navigate down to the &lt;strong&gt;Restart stopped Office C2R svc&lt;/strong&gt;.
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            From there we can follow a few steps to observe what the portal does while we load in some information.
                          &lt;/p&gt;
                          
                          &lt;ol&gt;
                            &lt;li&gt;
                              Press F12 to Open DevTools&lt;ul&gt;
                                &lt;li&gt;
                                  Open DevTools and switch to the Network tab
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              Adjust / Check some settings&lt;ul&gt;
                                &lt;li&gt;
                                  Make sure you are recording
                                &lt;/li&gt;
                                &lt;li&gt;
                                  Ensure Preserve Log is enabled
                                &lt;/li&gt;
                                &lt;li&gt;
                                  Disable Cache
                                &lt;/li&gt;
                                &lt;li&gt;
                                  If there are still a lot of entries, Filtering to &lt;strong&gt;XHR&lt;/strong&gt; type can be useful
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              Clear the existing history, which often still shows leftover entries from loading the page
                            &lt;/li&gt;
                            &lt;li&gt;
                              Refresh the Report
                            &lt;/li&gt;
                            &lt;li&gt;
                              Report URLs are shown down below in the Log
                            &lt;/li&gt;
                          &lt;/ol&gt;&lt;figure class=&quot;wp-block-image alignwide size-large&quot;&gt;
                          
                          ![](image-1024x584.png)&lt;/figure&gt; 
                          
                          &lt;p&gt;
                          &lt;/p&gt;
                          
                          &lt;p id=&quot;queryURL-example&quot;&gt;
                            So, here we can easily see that our URL that the report is referencing is
                          &lt;/p&gt;
                          
                          &lt;div class=&quot;wp-block-codemirror-blocks-code-block alignwide code-block&quot;&gt;
                            &lt;pre class=&quot;CodeMirror&quot; data-setting=&quot;{&quot;mode&quot;:&quot;webidl&quot;,&quot;mime&quot;:&quot;text/x-webidl&quot;,&quot;theme&quot;:&quot;default&quot;,&quot;lineNumbers&quot;:true,&quot;styleActiveLine&quot;:true,&quot;lineWrapping&quot;:true,&quot;readOnly&quot;:false,&quot;fileName&quot;:&quot;QueryURL&quot;,&quot;align&quot;:&quot;wide&quot;,&quot;language&quot;:&quot;Web IDL&quot;,&quot;modeName&quot;:&quot;webidl&quot;}&quot;&gt;https://graph.microsoft.com/beta/deviceManagement/deviceHealthScripts/02a4e7e8-195a-4824-8044-08b3a7f2d555/runSummary&lt;/pre&gt;
                          &lt;/div&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group alignwide&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group alignwide&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2 id=&quot;using-the-documentation&quot;&gt;
                            Using the Documentation
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            So, from our URL - we have three key terms to look up
                          &lt;/p&gt;
                          
                          &lt;div class=&quot;wp-block-codemirror-blocks-code-block alignwide code-block&quot;&gt;
                            &lt;pre class=&quot;CodeMirror&quot; data-setting=&quot;{&quot;mode&quot;:&quot;webidl&quot;,&quot;mime&quot;:&quot;text/x-webidl&quot;,&quot;theme&quot;:&quot;default&quot;,&quot;lineNumbers&quot;:true,&quot;styleActiveLine&quot;:true,&quot;lineWrapping&quot;:true,&quot;readOnly&quot;:false,&quot;align&quot;:&quot;wide&quot;,&quot;language&quot;:&quot;Web IDL&quot;,&quot;modeName&quot;:&quot;webidl&quot;}&quot;&gt;https://graph.microsoft.com/beta/deviceManagement/deviceHealthScripts/02a4e7e8-195a-4824-8044-08b3a7f2d555/runSummary&lt;/pre&gt;
                          &lt;/div&gt;
                          
                          &lt;ul&gt;
                            &lt;li&gt;
                              deviceManagement
                            &lt;/li&gt;
                            &lt;li&gt;
                              deviceHealthScripts
                            &lt;/li&gt;
                            &lt;li&gt;
                              runSummary
                            &lt;/li&gt;
                          &lt;/ul&gt;
                          
                          &lt;p&gt;
                            In general, the further to the right, the more specific area you are looking for. So here we are doing the action &lt;strong&gt;runSummary&lt;/strong&gt; on a specific &lt;strong&gt;deviceHealthScripts&lt;/strong&gt;. If you search these up, you can find the MS Graph endpoint [Get deviceHealthScriptRunSummary](https://docs.microsoft.com/graph/api/intune-devices-devicehealthscriptrunsummary-get?view=graph-rest-beta).
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            Now, right at the top of that page, it will tell you what API Permissions you need in the [Prerequisites section](https://docs.microsoft.com/graph/api/intune-devices-devicehealthscriptrunsummary-get?view=graph-rest-beta#prerequisites). A screenshot of this node is below.
                          &lt;/p&gt;&lt;figure class=&quot;wp-block-image size-large&quot;&gt;
                          
                          ![](image-1.png)&lt;/figure&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group alignwide&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2 id=&quot;getting-a-token&quot;&gt;
                            Getting a token for your API calls
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            Now that we know what Permissions Scopes we need to use, we can work on setting up our access methods to use this information in a script.
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            For simple testing, it is often convenient to just use the [MS Graph Explorer](https://developer.microsoft.com/graph/graph-explorer) or other [API Explorer Sites](#api-explorer-sites) to test and workshop a query, and you can find more intro to that [here](https://docs.microsoft.com/graph/graph-explorer/graph-explorer-overview), but when you want to automate something with minimal user interaction, a quick and easy way to get a token is through [MSAL](https://docs.microsoft.com/azure/active-directory/develop/msal-overview) or the Microsoft Authentication Library.
                          &lt;/p&gt;
                          
                          &lt;p id=&quot;using-a-token&quot;&gt;
                            Since PowerShell is my language of choice, I reach for [MSAL.PS](https://www.powershellgallery.com/packages/MSAL.PS).
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            Here is what a full script to implement the above query might look like
                          &lt;/p&gt;
                          
                          &lt;div class=&quot;wp-block-codemirror-blocks-code-block alignwide code-block&quot;&gt;
                            &lt;pre class=&quot;CodeMirror&quot; data-setting=&quot;{&quot;mode&quot;:&quot;powershell&quot;,&quot;mime&quot;:&quot;application/x-powershell&quot;,&quot;theme&quot;:&quot;default&quot;,&quot;lineNumbers&quot;:true,&quot;styleActiveLine&quot;:true,&quot;lineWrapping&quot;:true,&quot;readOnly&quot;:false,&quot;fileName&quot;:&quot;QueryUserAuthenticationMethods.ps1&quot;,&quot;align&quot;:&quot;wide&quot;,&quot;language&quot;:&quot;PowerShell&quot;,&quot;modeName&quot;:&quot;powershell&quot;}&quot;&gt;Install-Module MSAL.PS
</code></pre>
<p>$AuthParams = @{
ClientID = $YourAppID
TenantID = &lsquo;contoso.one&rsquo; #Also could use the GUID form from decoding your JWT token, like &lsquo;492d0e46-26b0-475c-82d0-102c962ea477&rsquo;
Scopes = &lsquo;DeviceManagementConfiguration.Read.All&rsquo;
LoginHint = &lsquo;<a href=mailto:YourUPN@Contoso.one>YourUPN@Contoso.one</a>&rsquo;
}</p>
<p>$Token = Get-MSALToken @AuthParams</p>
<p>$QueryParams = @{
queryURL = &lsquo;<a href="https://graph.microsoft.com/beta/deviceManagement/deviceHealthScripts/02a4e7e8-195a-4824-8044-08b3a7f2d555/runSummary'">https://graph.microsoft.com/beta/deviceManagement/deviceHealthScripts/02a4e7e8-195a-4824-8044-08b3a7f2d555/runSummary'</a>
Method = &lsquo;GET&rsquo;
}
Invoke-RestMethod -Headers @{Authorization = &ldquo;Bearer $($Token.AccessToken)"} @QueryParams
</p>
<pre><code>                          &lt;p&gt;
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group alignwide&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2&gt;
                            Another Example with a Less Common API
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            Let's find the &lt;strong&gt;[Authentication Methods Registration Detail](https://portal.azure.com/#blade/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/UserRegistrationDetails/menuId/UserRegistrationDetails)&lt;/strong&gt; report data.
                          &lt;/p&gt;&lt;figure class=&quot;wp-block-image alignwide size-large&quot;&gt;
                          
                          ![](image-10-1024x376.png)&lt;/figure&gt; 
                          
                          &lt;p&gt;
                            We go through the same DevTools process that we outlined above in &lt;strong&gt;[Watching How the Portal Works](#watching-the-portal-work)&lt;/strong&gt;.
                          &lt;/p&gt;&lt;figure class=&quot;wp-block-image alignwide&quot;&gt;
                          
                          ![This image has an empty alt attribute; its file name is image-11.png](image-11.png)&lt;/figure&gt; 
                          
                          &lt;p&gt;
                            This gives us the Query URL below.
                          &lt;/p&gt;
                          
                          &lt;div class=&quot;wp-block-codemirror-blocks-code-block alignwide code-block&quot;&gt;
                            &lt;pre class=&quot;CodeMirror&quot; data-setting=&quot;{&quot;mode&quot;:&quot;powershell&quot;,&quot;mime&quot;:&quot;application/x-powershell&quot;,&quot;theme&quot;:&quot;default&quot;,&quot;lineNumbers&quot;:true,&quot;styleActiveLine&quot;:true,&quot;lineWrapping&quot;:true,&quot;readOnly&quot;:false,&quot;fileName&quot;:&quot;QueryURL&quot;,&quot;align&quot;:&quot;wide&quot;,&quot;language&quot;:&quot;PowerShell&quot;,&quot;modeName&quot;:&quot;powershell&quot;}&quot;&gt;https://graph.windows.net/myorganization/activities/authenticationMethodUserDetails?$orderby=userPrincipalName%20asc&amp;api-version=beta&lt;/pre&gt;
                          &lt;/div&gt;
                          
                          &lt;p&gt;
                            Voila! Well... somewhat. Most people know of Microsoft Graph, but there are other Microsoft APIs that are available. Some variations include:
                          &lt;/p&gt;&lt;section class=&quot;wp-block-uagb-columns uagb-columns__wrap uagb-columns__background-undefined uagb-columns__stack-mobile uagb-columns__valign-undefined uagb-columns__gap-10 alignwide uagb-block-6aff5a46&quot; id=&quot;various-apis&quot;&gt;
                          
                          &lt;div class=&quot;uagb-columns__overlay&quot;&gt;
                          &lt;/div&gt;
                          
                          &lt;div class=&quot;uagb-columns__inner-wrap uagb-columns__columns-2&quot;&gt;
                            &lt;div class=&quot;wp-block-uagb-column uagb-column__wrap uagb-column__background-undefined uagb-block-bd0858c7&quot;&gt;
                              &lt;div class=&quot;uagb-column__overlay&quot;&gt;
                              &lt;/div&gt;
                              
                              &lt;div class=&quot;uagb-column__inner-wrap&quot;&gt;
                                &lt;ul&gt;
                                  &lt;li&gt;
                                    [Microsoft Graph APIs](https://docs.microsoft.com/graph/overview)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    [Microsoft 365 Defender APIs](https://docs.microsoft.com/microsoft-365/security/defender/api-overview)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    [Azure REST APIs](https://docs.microsoft.com/rest/api/azure/)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    [Dynamics APIs](https://docs.microsoft.com/dynamics-nav/fin-graph)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    [Intune API](https://docs.microsoft.com/en-us/mem/intune/developer/intune-graph-apis)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    [Office 365 Management APIs](https://msdn.microsoft.com/office-365/office-365-management-activity-api-reference)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    [Azure Rights Management SDK](https://docs.microsoft.com/azure/information-protection/develop/developers-guide)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    [Azure Storage Resource API](https://docs.microsoft.com/rest/api/storagerp/)
                                  &lt;/li&gt;
                                  &lt;li&gt;
                                    The list could go on for dozens of entries
                                  &lt;/li&gt;
                                &lt;/ul&gt;
                                
                                &lt;p&gt;
                                &lt;/p&gt;
                              &lt;/div&gt;
                            &lt;/div&gt;
                            
                            &lt;div class=&quot;wp-block-uagb-column uagb-column__wrap uagb-column__background-undefined uagb-block-e8d1b750&quot;&gt;
                              &lt;div class=&quot;uagb-column__overlay&quot;&gt;
                              &lt;/div&gt;
                              
                              &lt;div class=&quot;uagb-column__inner-wrap&quot;&gt;
                                &lt;figure class=&quot;wp-block-image size-large&quot;&gt;![](image-12.png)&lt;/figure&gt;
                              &lt;/div&gt;
                            &lt;/div&gt;
                          &lt;/div&gt;&lt;/section&gt; 
                          
                          &lt;p&gt;
                            In general terms [Microsoft Graph](https://docs.microsoft.com/graph/overview) is the main one and is slowly replacing some of the others to consolidate into one large API.
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            However, this example above references &lt;strong&gt;graph.windows.net&lt;/strong&gt; - which I know means it is using the [Legacy Azure AD Graph](https://docs.microsoft.com/azure/active-directory/develop/active-directory-graph-api). Now this is currently supported, but is actually already recommending to [migrate to Microsoft Graph](https://go.microsoft.com/fwlink/?linkid=2132805). For this example, I am focusing on recreating what the Portal is actively doing, so I won't look at the Microsoft Graph equivalent here (though it looks like this might be fairly similar - [credentialUserRegistrationDetails](https://docs.microsoft.com/graph/api/reportroot-list-credentialuserregistrationdetails))
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h3 id=&quot;what-api-is-it&quot;&gt;
                            OK - so what API &lt;em&gt;IS&lt;/em&gt; it using?
                          &lt;/h3&gt;
                          
                          &lt;p&gt;
                            Well - for the more obscure APIs - this can be a bit hard to find, and so hard to look up documentation for. Sometimes, there just isn't really public documentation for it.
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            If you are stuck trying to figure out what you are using, some very useful information can be gathered from your &lt;strong&gt;Bearer Token&lt;/strong&gt;. But first, we need to get one.
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h4 id=&quot;finding-your-token&quot;&gt;
                            Finding your Token
                          &lt;/h4&gt;
                          
                          &lt;p&gt;
                            Now, you can get tokens lots of ways, like [MSAL](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-overview), a number of [assorted Authentication Flows](https://docs.microsoft.com/en-us/azure/active-directory/develop/authentication-flows-app-scenarios), but we're watching the portal right now, and we already logged in. If we jump back to our F12 DevTools &gt; Network Tab - we can click on the entry we found before in [this section](#watching-the-portal-work), open the &lt;strong&gt;Headers&lt;/strong&gt; &gt; Scroll to the &lt;strong&gt;Request Headers&lt;/strong&gt; section &gt; &lt;strong&gt;Authorization&lt;/strong&gt;
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            This will give you a big beautiful base64 &lt;strong&gt;Bearer &lt;/strong&gt;blob, which is how the Portal authenticates for it's API calls in the background. You just have to de-crumple it into a usable state.
                          &lt;/p&gt;
                          
                          &lt;div class=&quot;wp-block-image&quot;&gt;
                            &lt;figure class=&quot;aligncenter size-large is-resized&quot;&gt;![](image-14-edited.png)&lt;/figure&gt;
                          &lt;/div&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;p&gt;
                      &lt;/p&gt;
                      
                      &lt;div class=&quot;wp-block-group&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h4 id=&quot;decoding-your-token&quot;&gt;
                            Decoding your Token
                          &lt;/h4&gt;
                          
                          &lt;p&gt;
                            Now, usually when you get a token for these APIs, it is a &lt;strong&gt;Bearer&lt;/strong&gt; token and a &lt;strong&gt;JSON Web Token&lt;/strong&gt; or &lt;strong&gt;JWT&lt;/strong&gt;. Now JWT's are an excellent and open standard you can read more about [here](https://jwt.io/), but the short version is that inside this big beautiful base64 blob are three parts.
                          &lt;/p&gt;
                          
                          &lt;ul&gt;
                            &lt;li&gt;
                              Header
                            &lt;/li&gt;
                            &lt;li&gt;
                              Claims/Payload
                            &lt;/li&gt;
                            &lt;li&gt;
                              Signature
                            &lt;/li&gt;
                          &lt;/ul&gt;
                          
                          &lt;p&gt;
                            The &lt;strong&gt;Bearer&lt;/strong&gt; at the beginning just references the type of token, but everything bolded below is one big chunk with all three parts. Well - if you want you can run it through a [Base64Decoder](https://www.base64decode.org/) - but the Signature part at the end comes out looking like random high ASCII.
                          &lt;/p&gt;
                          
                          &lt;pre id=&quot;bearer-example&quot; class=&quot;wp-block-preformatted&quot;&gt;Bearer&amp;nbsp;&lt;strong&gt;e01lc3NhZ2U6ICJEaWQgeW91IHRoaW5rIHRoaXMgd2FzIGdvaW5nIHRvIGhhdmUgYW4gYWN0dWFsIHJlYWwgdG9rZW4gaW4gaXQ/IEhhISAKV2VsbCBhcyBsb25nIGFzIHlvdSdyZSBoZXJlIC0gV2hhdCBpcyB5b3VyIGZhdm9yaXRlIGNvbG9yPyBPaC4uLiBobW1tLi4uIEkgd29uJ3QgcmVhbGx5IHNlZSB5b3VyIHJlc3BvbnNlIGhlcmUuIERhbW4uIFdlbGwgLSB0aGUgYmVzdCB3YXkgdG8gY2hhdCB3aXRoIG1lIGlzIHRvIGNvbWUgYnkgdGhlIFdpbkFkbWlucyBEaXNjb3JkLiBZb3UgY2FuIGdldCBhbiBpbnZpdGUgb3ZlciBoZXJlIGh0dHBzOi8vd2luYWRtaW5zLmlvL2Rpc2NvcmQgLiBDb21lIG9uIGJ5IHNvbWV0aW1lLCBhbmQgZmVlbCBmcmVlIHRvIHRhZyBtZSBhdCBAUHN5Y2hvRGF0YSBhbmQgdGVsbCBtZSB5b3VyIGZhdm9yaXRlIGNvbG9yISAKCkJldHRlciB5ZXQsIHNvbWV0aGluZyBmdW4uLi4uLiB0ZWxsIG1lIHlvdSBmb3VuZCBteSBsb3N0IHNvY2shIEl0IHdpbGwgY29uZnVzZSBldmVyeW9uZSBlbHNlIGFuZCBiZSBsb3RzIG9mIGdvb2QgZnVuISAKCldlbGwsIEknbSBhYm91dCBvdXQgb2YgdGhpbmdzIHRvIHJhbWJsZSBhYm91dC4uLiBTby4uIHVoaCBibHVyLXBsZT8gTW9udGdvbWVyeS4gVHVybnBpa2UuIFRoYXQncyBhbGwgSSBoYXZlIHNvIGhvcGUgdG8gY2hhdCBpbiBEaXNjb3JkIHNvbWUgdGltZSEiIH0KJeGIadj0TKLmjz_kgjH0byyuyGZA0CSRQDOP3tbP27tGoERHMQcyyWxv1J0ZtCDbAC7OWRQdxsf6YmcgKNmvyWCZDac2p6e2HGf9ZESfOCj6iFIQBR05FvByqudE_tPZlQgQk0wotkr3oQoxJQ&lt;/strong&gt;&lt;/pre&gt;
                          
                          &lt;p&gt;
                            However, there are services that know how to gracefully decode all the Microsoft Style bits and bobs. There is one public JWT decoder that you can paste your token into [here](https://jwt.io/#debugger-io), but Microsoft actually runs one of their own, and it will automatically identify the issuer of certain types of the tokens as well.
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group alignwide&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2 id=&quot;jwt-decoder&quot;&gt;
                            Useful Tools: Microsoft's JWT Decoder
                          &lt;/h2&gt;
                          
                          &lt;p class=&quot;has-text-align-center&quot;&gt;
                            [jwt.ms](https://jwt.ms)
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            The tool is very simple to use. Just paste your token (from a [browser session](#finding-your-token) or a token you [fetched yourself](#getting-a-token)) in the top of the page, and it is decoded on the bottom half.
                          &lt;/p&gt;
                          
                          &lt;p&gt;
                            This will also split out the different sections for you, and let you see helpful information like
                          &lt;/p&gt;&lt;figure class=&quot;wp-block-image alignwide size-large&quot;&gt;
                          
                          ![](image-13-1024x572.png)&lt;/figure&gt; &lt;figure class=&quot;wp-block-image size-large&quot;&gt;![](image-2.png)&lt;/figure&gt; 
                          
                          &lt;ul&gt;
                            &lt;li&gt;
                              what scopes (&lt;strong&gt;scp&lt;/strong&gt;) you have issued &lt;ul&gt;
                                &lt;li&gt;
                                  These are roughly equivalent to the permissions that you are requesting to use
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              from what issuer (&lt;strong&gt;iss&lt;/strong&gt;) &lt;ul&gt;
                                &lt;li&gt;
                                  This is the authority that issued a token. Most times you will see &quot;STS&quot; which stands for Security Token Service
                                &lt;/li&gt;
                                &lt;li&gt;
                                  This often relates to the tenant that is verifying you for example a issuer of https://sts.windows.net/efff978e-7235-6548-2347-09b768955994/ is issuing the token from tenant ID &lt;strong&gt;efff978e-7235-6548-2347-09b768955994&lt;/strong&gt;
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              for what site/service or audience (&lt;strong&gt;aud&lt;/strong&gt;) &lt;ul&gt;
                                &lt;li&gt;
                                  The Audience is often related closely to the API or Service that you are signing into, and is often related to the domain-portion of the Query URL you find in the DevTools Network tab.
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              what tenant ID you authenticated from (&lt;strong&gt;tid&lt;/strong&gt;)&lt;ul&gt;
                                &lt;li&gt;
                                  This often relates to the STS mentioned above
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              the authentication methods for this token (&lt;strong&gt;amr&lt;/strong&gt;)&lt;ul&gt;
                                &lt;li&gt;
                                  This can sometimes be used to tell if someone has entered a password, or especially if the user's session is verified with MFA
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              the expiration timestamp of the token (&lt;strong&gt;exp&lt;/strong&gt;)&lt;ul&gt;
                                &lt;li&gt;
                                  If you are testing, particularly if you got a token manually, your token might have expired on you. The error messages will usually help identify this, but you can pop it into the decoder to check
                                &lt;/li&gt;
                                &lt;li&gt;
                                  These are given in Epoch time, and for one-off I would use [EpochConverter.com](https://www.epochconverter.com/) or [in PowerShell](https://www.epoch101.com/Powershell#epoch-to-date-powershell).
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                          &lt;/ul&gt;
                          
                          &lt;p&gt;
                            A lot of this information can be helpful when you are dealing with some of these [less common APIs](#various-apis) besides common Microsoft Graph and when looking for documentation or troubleshooting.
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2 id=&quot;api-explorer-sites&quot;&gt;
                            Useful Tools: API Explorer websites
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            Several APIs have explorer websites. Here are several below, and there are probably more, and if you know of some, come by the [WinAdmins Discord](https://winadmins.io/discord), and tag me there [@PsychoData](https://discordapp.com/users/264652399824601088) or on [Twitter @PsychoData](https://twitter.com/psychodata) to let me know!
                          &lt;/p&gt;
                          
                          &lt;ul&gt;
                            &lt;li&gt;
                              [Microsoft Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer)
                            &lt;/li&gt;
                            &lt;li&gt;
                              [Azure Graph Explorer](https://graphexplorer.azurewebsites.net/#)
                            &lt;/li&gt;
                            &lt;li&gt;
                              [Azure Resource Explorer](https://resources.azure.com/)
                            &lt;/li&gt;
                          &lt;/ul&gt;
                          
                          &lt;p&gt;
                            You can search for more API and other resources here on this community listing of various [MS Portals](https://msportals.io/) - here are a couple searches that may be useful - [Explorer Sites](https://msportals.io/?search=explorer) - [Playground sites](https://msportals.io/?search=playground).
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h2&gt;
                            Conclusion
                          &lt;/h2&gt;
                          
                          &lt;p&gt;
                            With these processes, we have talked about how you can
                          &lt;/p&gt;
                          
                          &lt;ul&gt;
                            &lt;li&gt;
                              [Watch how the Portal is fetching information](#watching-the-portal-work)&lt;ul&gt;
                                &lt;li&gt;
                                  [See the tokens that the browser used](#finding-your-token) to fetch the data and
                                &lt;/li&gt;
                                &lt;li&gt;
                                  [decode the data in them](#decoding-your-token)
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              Find what APIs &amp; Scopes you need for these reports&lt;ul&gt;
                                &lt;li&gt;
                                  [using the](http://using-the-documentation)[ ](#using-the-documentation)[documentation](http://using-the-documentation)
                                &lt;/li&gt;
                                &lt;li&gt;
                                  using the [browser tools](#decoding-your-token)
                                &lt;/li&gt;
                              &lt;/ul&gt;
                            &lt;/li&gt;
                            
                            &lt;li&gt;
                              Authenticate to APIs and [get your own Bearer tokens](#getting-a-token)
                            &lt;/li&gt;
                            &lt;li&gt;
                              Using a token [in a script](#using-a-token) to expand your capabilities
                            &lt;/li&gt;
                          &lt;/ul&gt;
                          
                          &lt;p&gt;
                            There are thousands of API Endpoints, and they are adding more all the time, with all sorts of detailed information and functions available. What kind of things would you like to find out how the Portal Web-UI does?
                          &lt;/p&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                      
                      &lt;div class=&quot;wp-block-group&quot;&gt;
                        &lt;div class=&quot;wp-block-group__inner-container&quot;&gt;
                          &lt;h4&gt;
                            Where to find me
                          &lt;/h4&gt;
                          
                          &lt;div class=&quot;wp-block-columns are-vertically-aligned-center&quot;&gt;
                            &lt;div class=&quot;wp-block-column is-vertically-aligned-center&quot; style=&quot;flex-basis:66.66%&quot;&gt;
                              &lt;p&gt;
                                If you have questions, are having problems, or just want to chat over something, you can leave a comment below or reach me on the&amp;nbsp;[WinAdmins Discord](https://discord.com/invite/winadmins)&amp;nbsp;at&amp;nbsp;[@PsychoData](https://discordapp.com/users/264652399824601088)
                              &lt;/p&gt;
                            &lt;/div&gt;
                            
                            &lt;div class=&quot;wp-block-column is-vertically-aligned-center&quot; style=&quot;flex-basis:33.33%&quot;&gt;
                              &lt;div class=&quot;wp-block-buttons&quot;&gt;
                                &lt;div class=&quot;wp-block-button is-style-fill&quot;&gt;
                                  [WinAdmins Discord](https://discord.com/invite/winadmins)
                                &lt;/div&gt;
                              &lt;/div&gt;
                            &lt;/div&gt;
                          &lt;/div&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
</code></pre>
</div>
<div class=post-share>
<div class="post-share-box share-comments">
hello
</div>
</div>
<div class=post-author>
</div>
<comments id=comments>
<script src=https://utteranc.es/client.js repo=SysManSquad/sysmansquadblog issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script>
</comments>
</article>
</div>
</div>
</div>
<footer id=footer>
<div class=container>
<div id=footer-copyright>
<p class=copyright>&copy; 2021 WinAdmins - https://blog.sysmansquad.com - Systems Management Squad</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>