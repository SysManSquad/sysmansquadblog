<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=keyword content="ConfigMgr Microsoft Intune Windows WinAdmins">
<meta name=viewport content="width=device-width">
<meta name=description content="A community blog and subsidiary of WinAdmins.io">
<link rel="shortcut icon" href=/img/favicon.ico>
<title>Use Azure Policy to configure Boot Diagnostics Settings-SysManSquad | Systems Management Squad</title>
<link rel=canonical href=/2021/07/12/use-azure-policy-to-configure-boot-diagnostics-settings/>
<link rel=stylesheet href=/css/style.css>
<link rel=stylesheet href=https://blog.sysmansquad.com/css/custom.css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js></script>
<script src=https://blog.sysmansquad.com/js/jquery.slicknav.js></script>
<script src=https://blog.sysmansquad.com/js/asd_SlickNav_Mobile.js></script>
<script src=https://blog.sysmansquad.com/js/custom.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXZR1RSQYX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-XXZR1RSQYX',{anonymize_ip:!1})}</script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.sysmansquad.com/83">
<meta name=twitter:title content="Use Azure Policy to configure Boot Diagnostics Settings">
<meta name=twitter:description content="I found several posts about configuring Diagnostic Settings on VMs, but none that specified or included boot diagnostics.
With this Azure Policy you can automatically enable Boot Diagnostics and apply a storage account to it. This is also a great base if you want to start testing out your own policies.
1. Overview Our process will have several major parts
 Create a Custom Azure Policy Definition Assign to a Subscription or Resource Group  Find the Blob Storage URI to use   Create a Remediation task to Apply the changes Optional: Link to GitHub for versioning  2.">
</head>
<body class="home blog">
<div id=asd-container>
<div id=top-bar>
<div class=container>
<div id=nav-wrapper>
<ul class=menu id=menu-top-menu>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/>Home</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/about/>
<span>About</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=https://github.com/SysManSquad>
<span>GitHub</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/jointhesquad/>
<span>Join the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/meetthesquad/>
<span>Meet the Squad</span>
</a>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=#>
<span>MORE></span>
</a>
<ul class="sub-menu menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home">
<a href=/contact/>Contact</a>
</li>
</ul>
</li>
</ul>
</div>
<div id=top-search>
<a href=# class=search><i class="fa fa-search"></i></a>
<div class=show-search>
<form role=search method=get action=https://www.google.com/search id=searchform>
<input type=search placeholder="Search and hit enter..." name=q id=q title="Search and hit enter...">
<input type=hidden name=sitesearch value=https://blog.sysmansquad.com>
<button type=submit value=Search>
</form>
</div>
</div>
<div class=menu id=menu-mobile></div>
</div>
</div>
<header id=header class=noslider>
<div class=container>
<div id=logo>
<h1><a href=https://blog.sysmansquad.com><img src=/img/SysManSquad-HorizontalColor-Logo.png alt="Systems Management Squad"></a></h1>
</div>
</div>
</header>
<div class=container>
<div id=content>
<div id=main class=fullwidth>
<article class="post type-post status-publish format-standard has-post-thumbnail hentry">
<div class=post-header>
<h1>Use Azure Policy to configure Boot Diagnostics Settings</h1>
<p class=p-meta>
<span class=post-author><a href=/authors/kevin-crouch>Kevin Crouch</a> / </span>
<span class=post-date>July 12, 2021 </span>
<span class=post-categories>/ Endpoint Management </span>
</p>
</div>
<div class=post-entry>
<p>I found several posts about configuring Diagnostic Settings on VMs, but none that specified or included <strong>boot diagnostics</strong>.</p>
<p>With this Azure Policy you can automatically enable Boot Diagnostics and apply a storage account to it. This is also a great base if you want to start testing out your own policies.</p>
<h2 id=1-overview>1. Overview</h2>
<p>Our process will have several major parts</p>
<ul>
<li>Create a Custom Azure Policy Definition</li>
<li>Assign to a Subscription or Resource Group
<ul>
<li>Find the Blob Storage URI to use</li>
</ul>
</li>
<li>Create a Remediation task to Apply the changes</li>
<li>Optional: Link to GitHub for versioning</li>
</ul>
<h2 id=2create-a-custom-policy-definition>2.Create a Custom Policy Definition</h2>
<p>First we will need to Create a Custom Definition. To start with head to Portal.Azure.com > <a href=https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyMenuBlade/Definitions>Azure Policy | Definitions</a>.</p>
<p>From here, we will need to create a new Policy Definition
<div class=image>
<figure>
<a href=https://i.imgur.com/7ANVOqt.png target=_blank>
<img src=https://i.imgur.com/7ANVOqt.png alt=screenshot>
</a>
</figure>
</div> Fill in several fields</p>
<ul>
<li>&ldquo;Definition Location&rdquo; - which will be the Subscription.</li>
<li>Give it a name</li>
<li>Create a custom category, or select an existing one</li>
</ul>
<p><div class=image>
<figure>
<a href=https://i.imgur.com/BRJEnNY.png target=_blank>
<img src=https://i.imgur.com/BRJEnNY.png alt=screenshot>
</a>
</figure>
</div> For the Policy Rule Definition, you should be able to copy over this JSON below, or use <a href=https://gist.github.com/PsychoData/27c5028a5a78237f9910d4f652f6b269#file-enable_boot_diagnostics-json>this JSON</a>. Note: Later on, you can configure this to be deployed from a GitHub repo directly, though GitHub actions, but we will talk about that in a later section.</p>
<div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=1><a style=outline:none;text-decoration:none;color:inherit href=#1> 1</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=2><a style=outline:none;text-decoration:none;color:inherit href=#2> 2</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=3><a style=outline:none;text-decoration:none;color:inherit href=#3> 3</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=4><a style=outline:none;text-decoration:none;color:inherit href=#4> 4</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=5><a style=outline:none;text-decoration:none;color:inherit href=#5> 5</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=6><a style=outline:none;text-decoration:none;color:inherit href=#6> 6</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=7><a style=outline:none;text-decoration:none;color:inherit href=#7> 7</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=8><a style=outline:none;text-decoration:none;color:inherit href=#8> 8</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=9><a style=outline:none;text-decoration:none;color:inherit href=#9> 9</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=10><a style=outline:none;text-decoration:none;color:inherit href=#10>10</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=11><a style=outline:none;text-decoration:none;color:inherit href=#11>11</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=12><a style=outline:none;text-decoration:none;color:inherit href=#12>12</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=13><a style=outline:none;text-decoration:none;color:inherit href=#13>13</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=14><a style=outline:none;text-decoration:none;color:inherit href=#14>14</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=15><a style=outline:none;text-decoration:none;color:inherit href=#15>15</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=16><a style=outline:none;text-decoration:none;color:inherit href=#16>16</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=17><a style=outline:none;text-decoration:none;color:inherit href=#17>17</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=18><a style=outline:none;text-decoration:none;color:inherit href=#18>18</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=19><a style=outline:none;text-decoration:none;color:inherit href=#19>19</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=20><a style=outline:none;text-decoration:none;color:inherit href=#20>20</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=21><a style=outline:none;text-decoration:none;color:inherit href=#21>21</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=22><a style=outline:none;text-decoration:none;color:inherit href=#22>22</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=23><a style=outline:none;text-decoration:none;color:inherit href=#23>23</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=24><a style=outline:none;text-decoration:none;color:inherit href=#24>24</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=25><a style=outline:none;text-decoration:none;color:inherit href=#25>25</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=26><a style=outline:none;text-decoration:none;color:inherit href=#26>26</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=27><a style=outline:none;text-decoration:none;color:inherit href=#27>27</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=28><a style=outline:none;text-decoration:none;color:inherit href=#28>28</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=29><a style=outline:none;text-decoration:none;color:inherit href=#29>29</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=30><a style=outline:none;text-decoration:none;color:inherit href=#30>30</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=31><a style=outline:none;text-decoration:none;color:inherit href=#31>31</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=32><a style=outline:none;text-decoration:none;color:inherit href=#32>32</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=33><a style=outline:none;text-decoration:none;color:inherit href=#33>33</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=34><a style=outline:none;text-decoration:none;color:inherit href=#34>34</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=35><a style=outline:none;text-decoration:none;color:inherit href=#35>35</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=36><a style=outline:none;text-decoration:none;color:inherit href=#36>36</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=37><a style=outline:none;text-decoration:none;color:inherit href=#37>37</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=38><a style=outline:none;text-decoration:none;color:inherit href=#38>38</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=39><a style=outline:none;text-decoration:none;color:inherit href=#39>39</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=40><a style=outline:none;text-decoration:none;color:inherit href=#40>40</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=41><a style=outline:none;text-decoration:none;color:inherit href=#41>41</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=42><a style=outline:none;text-decoration:none;color:inherit href=#42>42</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=43><a style=outline:none;text-decoration:none;color:inherit href=#43>43</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=44><a style=outline:none;text-decoration:none;color:inherit href=#44>44</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=45><a style=outline:none;text-decoration:none;color:inherit href=#45>45</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=46><a style=outline:none;text-decoration:none;color:inherit href=#46>46</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=47><a style=outline:none;text-decoration:none;color:inherit href=#47>47</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=48><a style=outline:none;text-decoration:none;color:inherit href=#48>48</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=49><a style=outline:none;text-decoration:none;color:inherit href=#49>49</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=50><a style=outline:none;text-decoration:none;color:inherit href=#50>50</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=51><a style=outline:none;text-decoration:none;color:inherit href=#51>51</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=52><a style=outline:none;text-decoration:none;color:inherit href=#52>52</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=53><a style=outline:none;text-decoration:none;color:inherit href=#53>53</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=54><a style=outline:none;text-decoration:none;color:inherit href=#54>54</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=55><a style=outline:none;text-decoration:none;color:inherit href=#55>55</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=56><a style=outline:none;text-decoration:none;color:inherit href=#56>56</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=57><a style=outline:none;text-decoration:none;color:inherit href=#57>57</a>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=58><a style=outline:none;text-decoration:none;color:inherit href=#58>58</a>
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:navy>&#34;mode&#34;</span>: <span style=color:#d14>&#34;All&#34;</span>,
  <span style=color:navy>&#34;policyRule&#34;</span>: {
    <span style=color:navy>&#34;if&#34;</span>: {
      <span style=color:navy>&#34;allOf&#34;</span>: [
        {
          <span style=color:navy>&#34;field&#34;</span>: <span style=color:#d14>&#34;type&#34;</span>,
          <span style=color:navy>&#34;equals&#34;</span>: <span style=color:#d14>&#34;Microsoft.Compute/virtualMachines&#34;</span>
        },
        {
          <span style=color:navy>&#34;field&#34;</span>: <span style=color:#d14>&#34;tags&#34;</span>,
          <span style=color:navy>&#34;notContains&#34;</span>: <span style=color:#d14>&#34;IgnoreBootDiagnostics&#34;</span>
        },
        {
          <span style=color:navy>&#34;field&#34;</span>: <span style=color:#d14>&#34;Microsoft.Compute/virtualMachines/diagnosticsProfile.bootDiagnostics.storageUri&#34;</span>,
          <span style=color:navy>&#34;notContains&#34;</span>: <span style=color:#d14>&#34;[parameters(&#39;StorageURI&#39;)]&#34;</span>
        },
        {
          <span style=color:navy>&#34;not&#34;</span>: {
            <span style=color:navy>&#34;field&#34;</span>: <span style=color:#d14>&#34;Microsoft.Compute/virtualMachines/diagnosticsProfile.bootDiagnostics.storageUri&#34;</span>,
            <span style=color:navy>&#34;equals&#34;</span>: <span style=color:#d14>&#34;&#34;</span>
          }
        }
      ]
    },
    <span style=color:navy>&#34;then&#34;</span>: {
      <span style=color:navy>&#34;effect&#34;</span>: <span style=color:#d14>&#34;modify&#34;</span>,
      <span style=color:navy>&#34;details&#34;</span>: {
        <span style=color:navy>&#34;roleDefinitionIds&#34;</span>: [
          <span style=color:#d14>&#34;/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c&#34;</span>
        ],
        <span style=color:navy>&#34;conflictEffect&#34;</span>: <span style=color:#d14>&#34;audit&#34;</span>,
        <span style=color:navy>&#34;operations&#34;</span>: [
          {
            <span style=color:navy>&#34;operation&#34;</span>: <span style=color:#d14>&#34;addOrReplace&#34;</span>,
            <span style=color:navy>&#34;field&#34;</span>: <span style=color:#d14>&#34;Microsoft.Compute/virtualMachines/diagnosticsProfile.bootDiagnostics.storageUri&#34;</span>,
            <span style=color:navy>&#34;value&#34;</span>: <span style=color:#d14>&#34;[parameters(&#39;StorageURI&#39;)]&#34;</span>
          },
          {
            <span style=color:navy>&#34;operation&#34;</span>: <span style=color:#d14>&#34;addOrReplace&#34;</span>,
            <span style=color:navy>&#34;field&#34;</span>: <span style=color:#d14>&#34;Microsoft.Compute/virtualMachines/diagnosticsProfile.bootDiagnostics.enabled&#34;</span>,
            <span style=color:navy>&#34;value&#34;</span>: <span style=color:#000;font-weight:700>true</span>
          }
        ]
      }
    }
  },
  <span style=color:navy>&#34;parameters&#34;</span>: {
    <span style=color:navy>&#34;StorageURI&#34;</span>: {
      <span style=color:navy>&#34;type&#34;</span>: <span style=color:#d14>&#34;String&#34;</span>,
      <span style=color:navy>&#34;metadata&#34;</span>: {
        <span style=color:navy>&#34;displayName&#34;</span>: <span style=color:#d14>&#34;StorageURI&#34;</span>,
        <span style=color:navy>&#34;description&#34;</span>: <span style=color:#d14>&#34;Storage Account that will be applied to any account that does not already have one applied.&#34;</span>
      },
      <span style=color:navy>&#34;defaultValue&#34;</span>: <span style=color:#d14>&#34;https://YourBlobStorage.blob.core.windows.net&#34;</span>
    }
  }
}
</code></pre></td></tr></table>
</div>
</div><h2 id=3-assign-policy-to-resources>3. Assign Policy to Resources</h2>
<p>Next you can select a Resource Group or entire Subscription to apply to.</p>
<p>By default, the JSON policy provided will ignore any resources with the tag <strong>IgnoreBootDiagnostics</strong>, but you can also add <strong>Exclusions</strong> here, as well.</p>
<p><div class=image>
<figure>
<a href=https://i.imgur.com/1lJbBMM.png target=_blank>
<img src=https://i.imgur.com/1lJbBMM.png alt=screenshot>
</a>
</figure>
</div><br>
For the parameter, you need to fill in the URL to a Azure Blob storage service.</p>
<h3 id=get-your-blob-storage-endpoint>Get your Blob Storage Endpoint</h3>
<p>My example is <a href=https://YourBlobStorage.blob.core.windows.net>https://YourBlobStorage.blob.core.windows.net</a> , but you can find the endpoint for your Storage Account by opening your <a href=https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Storage%2FStorageAccounts>Storage Accounts</a> > Select or Create Relevant Storage account > Settings > Endpoints</p>
<p><div class=image>
<figure>
<a href=https://i.imgur.com/XIQQYC4.png target=_blank>
<img src=https://i.imgur.com/XIQQYC4.png alt=screenshot>
</a>
</figure>
</div></p>
<h2 id=4-create-remediation-task>4. Create Remediation Task</h2>
<p>Part of the assignment process will give you the option to create the Remediation Task.</p>
<p>Since the policy specifies the access needed, it will default to creating a managed Identity to remediate the issues.</p>
<p>Without the Remediation Task, the Policy will just Report Compliance or failure, but you can always start with no Remediation and then add it back later.</p>
<p><div class=image>
<figure>
<a href=https://i.imgur.com/4Ndafmo.png target=_blank>
<img src=https://i.imgur.com/4Ndafmo.png alt=screenshot>
</a>
</figure>
</div></p>
<h2 id=5-be-patient-and-enjoy>5. Be Patient and Enjoy</h2>
<p>In my experience, the policy will take around 15-45 minutes to evaluate, depending on the amount of resources it is checking over.</p>
<p>From there it usually takes <em>another</em> 30 minutes to multiple hours before the remediation runs. These are not the most immediate methods to apply the policy, but they can be fully automatic!</p>
<p>You can check your Remediation status by going to <a href=https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyMenuBlade/Assignments>Policy Assignments</a>> Select your policy name > Remediation tab</p>
<p><div class=image>
<figure>
<a href=https://i.imgur.com/JtkoH2i.png target=_blank>
<img src=https://i.imgur.com/JtkoH2i.png alt=screenshot>
</a>
</figure>
</div></p>
<p>To see the details, use the three-dots menu on the right to View remediation task</p>
<p><div class=image>
<figure>
<a href=https://i.imgur.com/qESeb98.png target=_blank>
<img src=https://i.imgur.com/qESeb98.png alt=screenshot>
</a>
</figure>
</div></p>
<h2 id=6-optional-export-to-github>6. Optional: Export to GitHub</h2>
<p>Modifying the Azure Policies can be a highly iterative process, so being able to reference or revert to previous versions can be an <strong>enormous</strong> benefit.</p>
<p>Azure Policies has this built in, including Automated Deployment from GitHub with GitHub Actions! You can read more about that <a href="https://docs.microsoft.com/azure/governance/policy/tutorials/policy-as-code-github?WT.mc_id=Portal-AzureTfsExtension#export-azure-policy-objects-from-the-azure-portal">here</a>, but the basic process is shown below.</p>
<p>Open <a href=https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyMenuBlade/Assignments>Azure Policy Assignments</a> > Select your assignment > <strong>View Definition</strong> button near the top > <strong>Export Definition</strong> button</p>
<p><div class=image>
<figure>
<a href=https://i.imgur.com/KGmXwlg.gif target=_blank>
<img src=https://i.imgur.com/KGmXwlg.gif alt=screenshot>
</a>
</figure>
</div></p>
<p>From there, you will need to authorize a connection to a GitHub account with rights to the Account/Repo you want to store the policy in.</p>
<p>Now, I would mention the important difference that the GitHub repo stores the Rules, Parameters, and any remaining parts into separate files within that Repo. Don&rsquo;t be surprised that it took your glorious new policy and chopped it up into different sections, and fills out a few metadata attributes.</p>
<p>If you aren&rsquo;t familiar with <a href=https://github.com/features/actions>GitHub Actions</a>, the export process will create a <strong>.github/workflows/manage_azure_policy_xxxxxx.yml</strong> that will outline the Workflow and use secrets to securely connect back to Azure.</p>
<p>To make future changes, commit them to the Repository and the GitHub Action will try to build the policy, apply it, and let you know if it was able to apply successfully.</p>
<img src=/authors/kevin-crouch/avatar.png alt="Photo of Kevin Crouch"><br>
<strong>Kevin Crouch</strong>
<em>Contributor</em>
<div>
<a href=https://twitter.com/PsychoData><img src=/img/social/twitter.png></a>
</div>
<p>System Administrator</p>
<hr>
</div>
<div class=post-share>
<div class="post-share-box share-comments">
hello
</div>
</div>
<comments id=comments>
<script src=https://utteranc.es/client.js repo=SysManSquad/sysmansquadblog issue-term=title label="blog comment" theme=github-light crossorigin=anonymous async></script>
</comments>
</article>
</div>
</div>
</div>
<footer id=footer>
<div class=container>
<div id=footer-copyright>
<p class=copyright>&copy; 2022 WinAdmins - https://blog.sysmansquad.com - Systems Management Squad</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>