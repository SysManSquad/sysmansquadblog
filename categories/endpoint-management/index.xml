<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Endpoint Management on Systems Management Squad</title><link>https://sysmansquad.com/categories/endpoint-management/</link><description>Recent content in Endpoint Management on Systems Management Squad</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 11 Apr 2023 00:14:00 +0000</lastBuildDate><atom:link href="https://sysmansquad.com/categories/endpoint-management/index.xml" rel="self" type="application/rss+xml"/><item><title>Dealing With Frontline Workers and OneDrive</title><link>https://sysmansquad.com/2023/04/11/Dealing-With-Frontline-Workers-OneDrive/</link><pubDate>Tue, 11 Apr 2023 00:14:00 +0000</pubDate><guid>https://sysmansquad.com/2023/04/11/Dealing-With-Frontline-Workers-OneDrive/</guid><description>OneDrive is an amazing product. It allows you to separate what&amp;rsquo;s important, the data, from the tools used to transform the data,the computer. Your CEOs laptop got dropped in a bathtub? No Problem. Hand them a laptop with Intune &amp;amp; Autopilot and they&amp;rsquo;ll be back up and running within an hour or so WITH all of their files. Despite it&amp;rsquo;s integral part to modern device management it has a few quirks that can make it a difficult product to administrate at times.</description></item><item><title>Moving away from software center to company portal</title><link>https://sysmansquad.com/2023/03/10/moving-away-from-software-center-to-company-portal/</link><pubDate>Fri, 10 Mar 2023 00:00:00 +0000</pubDate><guid>https://sysmansquad.com/2023/03/10/moving-away-from-software-center-to-company-portal/</guid><description>The elevator pitch You want to move your apps from configuration manager to Intune, but you need to keep the configuration manager client on your devices for various other reasons that have nothing to do with apps.
If you have switched the co-management workload over to intune, the apps in configuration manager will be visible in both software center and company portal, so how do you signal to your users to use the company portal going forward?</description></item><item><title>Import Intune Assets into ServiceNow without the costly plugins</title><link>https://sysmansquad.com/2022-05-20-import-intune-assets-into-servicenow-without-the-costly-plugin/</link><pubDate>Fri, 20 May 2022 00:00:00 +0000</pubDate><guid>https://sysmansquad.com/2022-05-20-import-intune-assets-into-servicenow-without-the-costly-plugin/</guid><description>In cases where an organization does not want to pay the hefty cost of servcenow’s integration hub, there is a way to still be able to import your intune assets into servicenow via the ms service graph api.
In this guide, we will be retrieving Intune assets and importing them into the ServiceNow CMDB.
Azure Setup Register an app to use Microsoft Graph API:
Sign in to the Microsoft Endpoint Manager admin center using administrative credentials.</description></item><item><title>Evaluating Apple MDM Products</title><link>https://sysmansquad.com/2022/05/03/2022-05-03-evaluating-apple-mdm-products/</link><pubDate>Tue, 03 May 2022 00:00:00 +0000</pubDate><guid>https://sysmansquad.com/2022/05/03/2022-05-03-evaluating-apple-mdm-products/</guid><description>About 6 months ago I moved to a new company and, after having been a Windows Admin for basically the previous decade, I’m now a de facto Mac Admin, though I don’t consider myself an expert in macOS or iOS yet. I’m learning quickly, but I also feel like I may have some more conservative views for managing Macs that definitely spill over from my Windows &amp;amp; ConfigMgr days.
When I was hired, I knew going in that my first major project would be migrating the entire company from one MDM (Meraki Systems Manger) to another as part of an effort to bring all endpoint management under in-house IT.</description></item><item><title>Preinstalling Windows Terminal on a Generalized Windows Image</title><link>https://sysmansquad.com/2022/01/23/2022-01-23-preinstalling-windows-terminal-on-a-generalized-windows-image/</link><pubDate>Sun, 23 Jan 2022 00:00:00 +0000</pubDate><guid>https://sysmansquad.com/2022/01/23/2022-01-23-preinstalling-windows-terminal-on-a-generalized-windows-image/</guid><description>In this post, I will show you the steps required to preinstall Windows Terminal (or any signed MSIX Application) to a generalized Windows image.
The goal of this post is to create an image of Windows 10 that can be deployed to an IT department that already has Windows Terminal baked into the OS, instead of having to go out to the Windows Store and install it yourself
NOTE: This only works on a generalized image.</description></item><item><title>A Password Expiration Script</title><link>https://sysmansquad.com/2021/11/23/2021-11-23-a-password-expiration-script/</link><pubDate>Tue, 23 Nov 2021 00:00:00 +0000</pubDate><guid>https://sysmansquad.com/2021/11/23/2021-11-23-a-password-expiration-script/</guid><description>Script Introduction This post will go through the steps required to create and deploy a password expiration script to run daily and send an email to all users whose passwords will expire in a set number of days.
Scheduled tasks are the recommended implementation for this password expiration script. There are probably other ways to implement this script; however, this script targets scheduled tasks in Windows.
1 2 3 4 #Clear any stored errors $error.</description></item><item><title>Deploy Azure VPN Client to Mac</title><link>https://sysmansquad.com/2022/05/31/2022-05-31-deploy-azure-vpn-client-to-mac/</link><pubDate>Mon, 22 Nov 2021 00:00:00 +0000</pubDate><guid>https://sysmansquad.com/2022/05/31/2022-05-31-deploy-azure-vpn-client-to-mac/</guid><description>App deployment for any computer, Windows or Mac, can be challenging. Widely used apps like Google Chrome are well-developed with options to automate and configure using scripts, MDM config profiles, or even back one-liner terminal commands.
When you encounter an app that has little-to-no documented parameters or configurations, it can be frustrating. I choose to look at it as a challenge. Using any tools or ideas available, it’s easy for me to become engrossed in finding an automatable solution.</description></item><item><title>FSLogix App Masking Rules for M365 Apps</title><link>https://sysmansquad.com/2021/11/22/2021-11-22-fslogix-app-masking-rules-m365/</link><pubDate>Mon, 22 Nov 2021 00:00:00 +0000</pubDate><guid>https://sysmansquad.com/2021/11/22/2021-11-22-fslogix-app-masking-rules-m365/</guid><description>I’m deploying Azure Virtual Desktop currently for a client and they want a “general shared desktop” pool that will have a bunch of core apps including Microsoft 365 Apps installed. However, not every user will be licensed for Visio or Project, and only a very select few users are allowed to use Publisher, and fewer still allowed MS Access (They’ve signed contracts so that if they dare create anything in Access, they have to support it for free till day they die, then their next of kin take over support.</description></item><item><title>Microsoft Teams Cache, a burden to us all</title><link>https://sysmansquad.com/2021/11/11/microsoft-teams-cache-a-burden-to-us-all/</link><pubDate>Fri, 12 Nov 2021 02:10:08 +0000</pubDate><guid>https://sysmansquad.com/2021/11/11/microsoft-teams-cache-a-burden-to-us-all/</guid><description>Microsoft Teams Cache, we&amp;rsquo;ve all been there in the last year and a half. Microsoft Teams is working fine, then it&amp;rsquo;s not. What happened? I restarted Teams and it&amp;rsquo;s still acting weird.
Well, Teams is an interesting app when it comes to its cache. It relies heavily on it. I personally do not know all the ins and outs of the Teams cache, but I too know all too well that it is a pain in the butt when it goes awry.</description></item><item><title>Get rid of the “Continue connecting?” prompt for your policy-configured wifi networks</title><link>https://sysmansquad.com/2021/10/18/get-rid-of-the-continue-connecting-prompt-for-your-policy-configured-wifi-networks/</link><pubDate>Mon, 18 Oct 2021 19:05:26 +0000</pubDate><guid>https://sysmansquad.com/2021/10/18/get-rid-of-the-continue-connecting-prompt-for-your-policy-configured-wifi-networks/</guid><description>As of Windows 11, we noticed that we were getting prompted to continue connecting to a network that we&amp;rsquo;d never had a problem with before. It&amp;rsquo;s already defined in group policy, so this new behavior is puzzling and annoying. The certificate in question is for the NPS/Radius server our network uses to validate credentials for the wifi.
Continue Connecting I really had no idea how to even begin googling for this problem, but while talking to some of my fellow nerds on the Winadmins Discord server, tossing around some ideas on what could be causing this, looking to see whether there was a problem with the certificate, etc.</description></item><item><title>Removing The Built-in Teams App in Windows 11 with Intune</title><link>https://sysmansquad.com/2021/10/08/removing-the-built-in-teams-app-in-windows-11-with-intune/</link><pubDate>Fri, 08 Oct 2021 13:59:21 +0000</pubDate><guid>https://sysmansquad.com/2021/10/08/removing-the-built-in-teams-app-in-windows-11-with-intune/</guid><description>Intro So you&amp;rsquo;ve started rolling out Windows 11 to your endpoints, and your users got confused and upset over the consumer teams apps that is installed? Understandably you wish to do something about this.
(╯°□°）╯︵ ┻━┻ No worries mate, Intune Proactive Remediations to the rescue!
The Solution The code below fixes two things.
It removes the chat by writing the registry key that disables it
the TaskbarMn DWORD controls this Then it simply uninstalls the appx package for the consumer teams app, note that this has no effect on the regular teams app.</description></item><item><title>Installing The Configuration Manager Client During Autopilot</title><link>https://sysmansquad.com/2021/08/30/installing-the-configuration-manager-client-during-autopilot/</link><pubDate>Tue, 31 Aug 2021 03:24:39 +0000</pubDate><guid>https://sysmansquad.com/2021/08/30/installing-the-configuration-manager-client-during-autopilot/</guid><description>Hey Siri, Write A Blog Post For Me THE CONTENTS IN THIS POST IS EXPIRED, DO NOT USE THIS ANYMORE This method of installing the Configuration Manager Client during Autopilot is no longer needed
Please use the new autopilot into co-management feature.
Autopilot into Co-Management Overview
Installing the SCCM Client During Autopilot
EXPIRED CONTENT BELOW Deploying the Configuration manager client is usually pretty simple. the procedure is well documented.
However there are issues if you plan on installing the CM client during Autopilot using the officially suggested methods</description></item><item><title>Use Azure Policy to configure Boot Diagnostics Settings</title><link>https://sysmansquad.com/2021/07/12/use-azure-policy-to-configure-boot-diagnostics-settings/</link><pubDate>Mon, 12 Jul 2021 17:42:11 +0000</pubDate><guid>https://sysmansquad.com/2021/07/12/use-azure-policy-to-configure-boot-diagnostics-settings/</guid><description>I found several posts about configuring Diagnostic Settings on VMs, but none that specified or included boot diagnostics.
With this Azure Policy you can automatically enable Boot Diagnostics and apply a storage account to it. This is also a great base if you want to start testing out your own policies.
1. Overview Our process will have several major parts
Create a Custom Azure Policy Definition Assign to a Subscription or Resource Group Find the Blob Storage URI to use Create a Remediation task to Apply the changes Optional: Link to GitHub for versioning 2.</description></item><item><title>Setting Environmental Variables with Intune and proactive remediations</title><link>https://sysmansquad.com/2021/07/02/setting-environmental-variables-with-intune-and-proactive-remediations/</link><pubDate>Fri, 02 Jul 2021 05:24:25 +0000</pubDate><guid>https://sysmansquad.com/2021/07/02/setting-environmental-variables-with-intune-and-proactive-remediations/</guid><description>As you may have noticed by now, there doesn&amp;rsquo;t seem to be any nice built in way to set environmental variables in intune 🙁
The Problem Setting a user environmental variable using powershell is an easy task to accomplish, you basically just run the following:
1 Set-ItemProperty -Path HKCU:\Environment -Name temp -Value &amp;#34;c:\temp\&amp;#34; This works just fine, but won&amp;rsquo;t take effect until the user either reboots or signs into the device again.</description></item><item><title>Setting A Default Outlook Signature in Outlook using Intune Proactive Remediations</title><link>https://sysmansquad.com/2021/06/18/setting-a-default-outlook-signature-in-outlook-using-intune-proactive-remediations/</link><pubDate>Fri, 18 Jun 2021 12:37:50 +0000</pubDate><guid>https://sysmansquad.com/2021/06/18/setting-a-default-outlook-signature-in-outlook-using-intune-proactive-remediations/</guid><description>So you have already figured out how to dynamically generated outlook signatures, but now you want to make sure that people actually use them. but without preventing the use of other signatures your users might have.
Well it just so happens that I have a solution for you!
No default signature has been set
To do all this, we create a new Proactive Remediation in Intune.
Add the detection and remediations scripts from below, and set it to run as the user.</description></item><item><title>Working around NPS limitations for AADJ Windows devices</title><link>https://sysmansquad.com/2021/04/27/working-around-nps-limitations-for-aadj-windows-devices/</link><pubDate>Wed, 28 Apr 2021 03:10:47 +0000</pubDate><guid>https://sysmansquad.com/2021/04/27/working-around-nps-limitations-for-aadj-windows-devices/</guid><description>⚠️ UPDATE (2023-03-11) ⚠️ Due to changes introduced by Microsoft in KB5014754 and being enforced on November 14, 2023, the name mapping method used in the scripts below will no longer work, and authentication will fail at that time. Thankfully, commenter Anders Hannus has pointed out a policy module named TameMyCerts for Microsoft Active Directory Certificate Services (AD CS). This policy module, used in conjunction with the below scripts, will let us work around Microsoft&amp;rsquo;s changes and give us the added benefit of no longer needing name mappings that are insecure.</description></item><item><title>Updated Modern Driver/BIOS Management with CMG Support</title><link>https://sysmansquad.com/2021/04/27/updated-modern-driver-bios-management-with-cmg-support/</link><pubDate>Wed, 28 Apr 2021 03:04:02 +0000</pubDate><guid>https://sysmansquad.com/2021/04/27/updated-modern-driver-bios-management-with-cmg-support/</guid><description>Hello,
This is a long and overdue update on a solution I started working on last year to allow my organization to use the modern driver management solution without the need of the custom webservice. I also wanted the solution to use the built-in task sequence steps as much as possible to allow other administrators to customize the solution to their need without the need to go modify a big PowerShell script.</description></item><item><title>Create a new WinPE boot image</title><link>https://sysmansquad.com/2021/02/22/create-a-new-winpe-boot-image/</link><pubDate>Mon, 22 Feb 2021 09:51:23 +0000</pubDate><guid>https://sysmansquad.com/2021/02/22/create-a-new-winpe-boot-image/</guid><description>Introduction In this post I&amp;rsquo;ll show you how you can create a new boot image in ConfigMgr.
There&amp;rsquo;s plenty of good content out there already on this, but I was interested to write this because I didn&amp;rsquo;t see many PowerShell examples out there until I came across Michael Niehaus&amp;rsquo; post on Build your own Windows PE image. A fantastic post, highly recommend reading it. Michael provided a useful script at the end of this post in a .</description></item><item><title>Keeping Up with Distribution Points</title><link>https://sysmansquad.com/2021/02/17/keeping-up-with-distribution-points/</link><pubDate>Wed, 17 Feb 2021 15:24:30 +0000</pubDate><guid>https://sysmansquad.com/2021/02/17/keeping-up-with-distribution-points/</guid><description>Distribution Points are great, but they can often be a huge annoyance. Getting content distributed is one thing, but then making sure it STAYS distributed, and old things are getting cleaned up, and making sure all the content hashes are correct, etc. It’s easy to feel like you’re constantly drowning in a sea of DP warnings and errors.
Luckily, there’s some simple things we can do to take this burden away.</description></item><item><title>Multilingual Windows 10 20H2 OSD with ConfigMgr</title><link>https://sysmansquad.com/2021/02/16/multilingual-windows-10-20h2-osd-with-configmgr/</link><pubDate>Tue, 16 Feb 2021 10:06:58 +0000</pubDate><guid>https://sysmansquad.com/2021/02/16/multilingual-windows-10-20h2-osd-with-configmgr/</guid><description>Introduction In this post I&amp;rsquo;m going to share with you a task sequence for ConfigMgr / SCCM / MEMCM / MECM / MCM (this is just getting silly now) that localises Windows 10 to a language other than the default language of the OS install media.
This is a follow up from my previous post Language Packs, Language Experience Packs, Language Interface Packs… what?!
In that post I broke down the necessary bits in order to understand how to localise a Windows system.</description></item><item><title>Trigger Teams Installer for User After Machine Wide Installer</title><link>https://sysmansquad.com/2021/01/26/trigger-teams-installer-for-user-after-machine-wide-installer/</link><pubDate>Tue, 26 Jan 2021 12:30:17 +0000</pubDate><guid>https://sysmansquad.com/2021/01/26/trigger-teams-installer-for-user-after-machine-wide-installer/</guid><description>The Problem: Teams Machine Wide Installer finishes&amp;hellip; Then&amp;hellip; Nothing? Have you or a loved one ever deployed Microsoft Teams in an enterprise environment? Did the users complain? Did project management complain? Management? You?
I&amp;rsquo;m sure someone was not happy about the overall user experience. In particular when the Teams Machine Wide installer is finished, and detected by your application management tool of choice it does&amp;hellip; nothing. The user is left with a message claiming Teams is &amp;lsquo;Installed&amp;rsquo; when clearly it is not.</description></item><item><title>Collecting Logs with Log Analytics for Intune devices</title><link>https://sysmansquad.com/2021/01/18/collecting-logs-with-log-analytics-for-intune-devices/</link><pubDate>Mon, 18 Jan 2021 17:38:51 +0000</pubDate><guid>https://sysmansquad.com/2021/01/18/collecting-logs-with-log-analytics-for-intune-devices/</guid><description>Why do I need logs? The purpose of this guide is to configure the collection of Logs in an Intune environment. By default the log analytics you enable in Intune does not give you much information beyond auditing basic things. With this approach we can record any desired log for all of our machines. There is a companion video for this setup https://youtu.be/Uw3GjMnSXbI.
Enabling Log Analytics Navigate to endpoint.microsoft.com Select Reports Select Diagnostic Settings Select Add Diagnostic setting Select all options under Log Select Send to Log Analytics workspace Select a Log Analytics workspace You can archive to a storage account to keep data longer Now that we have the log analytics workspace configured we can configure the Microsoft Monitoring Agent (MMA)</description></item><item><title>Finding Azure Virtual Machines in Configuration Manager</title><link>https://sysmansquad.com/2021/01/05/finding-azure-virtual-machines-in-configuration-manager/</link><pubDate>Wed, 06 Jan 2021 05:04:40 +0000</pubDate><guid>https://sysmansquad.com/2021/01/05/finding-azure-virtual-machines-in-configuration-manager/</guid><description>A request came in from my System Admin group to push certain policies only to VMs hosted in Azure. Currently, they had a naming convention being used (well, supposed to be used) to simply prefix the hostname with AZ-, but they came across a couple Domain Controllers that hadn&amp;rsquo;t installed Updates in 7+ months, and of course the names didn&amp;rsquo;t follow the accepted standard.
So I started looking for ways to identify Azure devices definitively and came across this Detect Windows Azure Virtual Machine post, which led to reading the Azure Metadata Service docs, and eventually got me to turn this into a Configuration Item / Configuration Baseline and subsequent Device Collections.</description></item><item><title>Automating Outside of Business Hours Responses</title><link>https://sysmansquad.com/2020/12/30/automating-changing-out-of-business-hours-responses/</link><pubDate>Wed, 30 Dec 2020 19:20:15 +0000</pubDate><guid>https://sysmansquad.com/2020/12/30/automating-changing-out-of-business-hours-responses/</guid><description>Have you ever had customers emailing in outside of hours? In this post we will setup some scripted automatic maintenance of Auto-Reply responses on a user account.
We considered several possibilities but the customer did not have an Azure Subscription yet, we ended up using PowerShell, Microsoft Graph, App Authentication, and a Scheduled Task.
Our customer will be moving to Azure later so we will probably revisit this as Azure Functions, or possibly Power Automate later on.</description></item><item><title>Mapping Network Drives on Intune Devices</title><link>https://sysmansquad.com/2020/12/16/mapping-network-drives-on-intune-devices/</link><pubDate>Wed, 16 Dec 2020 19:04:49 +0000</pubDate><guid>https://sysmansquad.com/2020/12/16/mapping-network-drives-on-intune-devices/</guid><description>This guide is part of a video series companion guide on setting up mapped drives on Intune devices - you can watch the video here S02E18 How to Map Network Drives on Microsoft Intune Devices - (I.T)! This is rather simple but I will be adding some useful bits of code for people who do not have an always on VPN solution for all those Work From Home scenarios.
Creating the script Before we get started let me explain how this process works.</description></item><item><title>Downloading a Device Guard Signing Service version 2 Root Certificate for MSIX</title><link>https://sysmansquad.com/2020/11/01/downloading-a-device-guard-signing-service-version-2-root-certificate-for-msix/</link><pubDate>Mon, 02 Nov 2020 03:54:11 +0000</pubDate><guid>https://sysmansquad.com/2020/11/01/downloading-a-device-guard-signing-service-version-2-root-certificate-for-msix/</guid><description>Howdy y&amp;rsquo;all
In this post I will show you how to get the Device Guard Signing Service v2 root certificate.
Device Guard Signing Services v1 (DGSS) is being deprecated at the end of December 2020, so we need to migrate to DGSSv2, and it just so happens that the means to download the DGSSv2 root cert is a little bit more complex than the DGSSv1.
MSIX crash course While MSIX is generally marketed as a replacement for MSI for developers, there are scenarios that can benefit systems administrators.</description></item><item><title>ConfigMgr and The Case of the Mysterious {3DA228BE-34DA-49f4-A081-66465B077429} Folder</title><link>https://sysmansquad.com/2020/09/30/configmgr-and-the-case-of-the-mysterious-3da228be-34da-49f4-a081-66465b077429-folder/</link><pubDate>Wed, 30 Sep 2020 05:50:17 +0000</pubDate><guid>https://sysmansquad.com/2020/09/30/configmgr-and-the-case-of-the-mysterious-3da228be-34da-49f4-a081-66465b077429-folder/</guid><description>Over the weekend I ran into a weird issue that I hadn&amp;rsquo;t seen before. I was upgrading half of the Distribution Points for a client who&amp;rsquo;s ConfigMgr was in need of some TLC. I&amp;rsquo;ve been working on getting their overall infrastructure healthy and that includes upgrading their DPs from Windows Server 2012 to Windows Server 2016 (and eventually 2019).
Once I started the upgrades I worked on other things while checking in on them periodically.</description></item><item><title>Signing and Deploying Applications via MSIX with Intune</title><link>https://sysmansquad.com/2020/09/15/signing-and-deploying-applications-via-msix-with-intune/</link><pubDate>Tue, 15 Sep 2020 17:22:10 +0000</pubDate><guid>https://sysmansquad.com/2020/09/15/signing-and-deploying-applications-via-msix-with-intune/</guid><description>Why would I want to use MSIX and what is it? MSIX is a Windows app package format that provides a modern packaging experience to all Windows apps. The MSIX package format preserves the functionality of existing app packages and/or install files in addition to enabling new, modern packaging and deployment features to Win32, WPF, and Windows Forms apps.
Do you have a bloated application? Maybe one or two that are so old it doesn&amp;rsquo;t even have any install parameters?</description></item><item><title>VPN Boundary Type and Understanding Its Options</title><link>https://sysmansquad.com/2020/09/14/vpn-boundary-type-and-understanding-its-options/</link><pubDate>Mon, 14 Sep 2020 12:34:34 +0000</pubDate><guid>https://sysmansquad.com/2020/09/14/vpn-boundary-type-and-understanding-its-options/</guid><description>Like many, I was very excited that the new Configuration Manager 2006 release included a huge improvement for remote devices by adding a new VPN Boundary type.
&amp;ldquo;Finally! I don&amp;rsquo;t have to constantly bug my Network Engineers as to which IP pools are being used for which VPN appliances.&amp;rdquo;
Create A New Boundary In the Admin Console, navigate to the Administration Node and open up Hierarchy Configuration and right-click on Boundaries</description></item><item><title>Allow OneDrive Syncing on AAD joined Devices</title><link>https://sysmansquad.com/2020/09/11/allow-onedrive-syncing-on-aad-joined-devices/</link><pubDate>Fri, 11 Sep 2020 17:23:02 +0000</pubDate><guid>https://sysmansquad.com/2020/09/11/allow-onedrive-syncing-on-aad-joined-devices/</guid><description>The Problem So I was walking on the beach and noticed that OneDrive wasn&amp;rsquo;t syncing anymore on my AzureAD joined laptop. I later learned that my endpoint administrator, Adam Gross, had enabled Allow syncing only on computers joined to specific domains in the OneDrive admin portal. which effectively blocked my AzureAD device 🙁
Which resulted in this message on my corporate device
Our Legacy AD joined devices were fine, but all of our Azure AD joined devices got the above error.</description></item><item><title>Manage Distribution Point Content Using PSCMContentMgmt</title><link>https://sysmansquad.com/2020/09/04/manage-distribution-point-content-using-pscmcontentmgmt/</link><pubDate>Fri, 04 Sep 2020 21:59:36 +0000</pubDate><guid>https://sysmansquad.com/2020/09/04/manage-distribution-point-content-using-pscmcontentmgmt/</guid><description>Introduction I recently wrote PSCMContentMgmt which provides a simple and effective workflow for managing your MEMCM distribution points. Here are some of the things you can do with it:
Query content objects which are distributed to distribution point(s) or distribution point group(s) Compare content objects distributed to distribution point(s) or distribution point group(s) Find content objects in a &amp;ldquo;distribution failed&amp;rdquo; state for all or selective distribution points Remove, distribute or redistribute content objects returned by any function to distribution point(s) Find an object in your site by searching on any arbitrary ID (useful when reading logs and want to know what object an ID resolves to) Migrate a distribution point&amp;rsquo;s content to a new/different distribution point by exporting its content library to prestaged .</description></item><item><title>Getting Reboot History and Optimizing Legacy Functions</title><link>https://sysmansquad.com/2020/08/28/getting-reboot-history-and-optimizing-legacy-functions/</link><pubDate>Fri, 28 Aug 2020 14:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/08/28/getting-reboot-history-and-optimizing-legacy-functions/</guid><description>The other day, I logged on to a jump server and, while investigating an unrelated issue, I noticed the BG Info background showed the Last Reboot as March 1st, 2020. &amp;ldquo;That can&amp;rsquo;t be right,&amp;rdquo; I thought. &amp;ldquo;We have weekly maintenance windows to reboot these servers.&amp;rdquo;
As I opened an old stand-by function from my stash (originally posted here: https://gallery.technet.microsoft.com/scriptcenter/Get-RebootHistory-bc804819 in 2015) and ran it, I was a bit annoyed at how SLOW it was.</description></item><item><title>Enrolling and Autopiloting New and Pre-existing Devices into Intune with ConfigMgr – EDU</title><link>https://sysmansquad.com/2020/08/25/enrolling-and-autopiloting-new-and-pre-existing-devices-into-intune-with-configmgr-edu/</link><pubDate>Tue, 25 Aug 2020 15:45:46 +0000</pubDate><guid>https://sysmansquad.com/2020/08/25/enrolling-and-autopiloting-new-and-pre-existing-devices-into-intune-with-configmgr-edu/</guid><description>Months after we issued students and faculty 600+ unmanaged off the shelf laptops (no AD, no Azure AD, no Intune, no ConfigMgr) to get them off and running temporarily during this pandemic, my co-worker and I were tasked with figuring out how to bring these machines under some form of management. We did not have these machines in ConfigMgr or have the hardware hashes uploaded into Intune, so we had some work ahead of us.</description></item><item><title>Bulk Updating Autopilot enrolled devices with Graph API and assigning a Group Tag based on Purchase OrderID</title><link>https://sysmansquad.com/2020/08/24/bulk-updating-autopilot-enrolled-devices-with-graph-api-and-assigning-a-group-tag-based-on-purchase-orderid/</link><pubDate>Mon, 24 Aug 2020 14:31:46 +0000</pubDate><guid>https://sysmansquad.com/2020/08/24/bulk-updating-autopilot-enrolled-devices-with-graph-api-and-assigning-a-group-tag-based-on-purchase-orderid/</guid><description>The Problem For any new machines ordered from a vendor such as Dell that get enrolled into Autopilot you get the basic device info enrolled but nothing defining that would let it get auto-enrolled into a dynamic group easily. Purchase Order ID is included in every order we receive from Dell however I don&amp;rsquo;t want to have to add that Purchase Order ID into the dynamic device query every time a new machine gets added.</description></item><item><title>Setting ACL using Intune Endpoint Analytics Proactive Remediations</title><link>https://sysmansquad.com/2020/07/27/setting-acl-using-intune-endpoint-analytics-proactive-remediations/</link><pubDate>Mon, 27 Jul 2020 14:56:26 +0000</pubDate><guid>https://sysmansquad.com/2020/07/27/setting-acl-using-intune-endpoint-analytics-proactive-remediations/</guid><description>Namaste y&amp;rsquo;all! In todays Siri dictated blog post, I will show you how you can configure access control lists (ACL) for a directory using Intune Proactive remediations.
The issue I was facing was that regular users do not have modify permissions to the public desktop on their corporate devices, meaning that the user is unable to remove annoying shortcuts that would get placed there by the various apps they install. While this is hardly a high priority task to solve.</description></item><item><title>Dynamic Outlook Email Signature Using with Intune Endpoint Analytics Proactive Remediations</title><link>https://sysmansquad.com/2020/07/08/dynamic-outlook-email-signature-using-with-intune-endpoint-analytics-proactive-remediations/</link><pubDate>Thu, 09 Jul 2020 03:09:31 +0000</pubDate><guid>https://sysmansquad.com/2020/07/08/dynamic-outlook-email-signature-using-with-intune-endpoint-analytics-proactive-remediations/</guid><description>Howdy y&amp;rsquo;all!
Since you have already read señor Shackelfords blog post on setting up Endpoint Analytics Proactive remediations, we can skip the intro and dive right in.
In this blog post we will be get familiar with a somewhat novel idea that proactive remediation&amp;rsquo;s can be used for. Which, as the title of this post suggests, is the creation of a dynamic email signature in the form of a .html file using Microsoft Graph.</description></item><item><title>Intune/Autopilot Proactive Remediation</title><link>https://sysmansquad.com/2020/07/07/intune-autopilot-proactive-remediation/</link><pubDate>Tue, 07 Jul 2020 16:24:57 +0000</pubDate><guid>https://sysmansquad.com/2020/07/07/intune-autopilot-proactive-remediation/</guid><description>What is Proactive Remediation? Proactive remediations are a pair of scripts used to detect and remediate a problem on a machine. The first script runs a query on your endpoints that returns an exit code of success or failure. We call this first script the detection script. On a successful exit code it is reported as &amp;ldquo;Without issue&amp;rdquo; in the Intune portal and nothing else is executed. On a failed exit code the second script is run which is called a remediation script.</description></item><item><title>Modern BIOS Management with the Administration Service</title><link>https://sysmansquad.com/2020/06/18/modern-bios-management-with-the-administration-service/</link><pubDate>Thu, 18 Jun 2020 13:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/06/18/modern-bios-management-with-the-administration-service/</guid><description>2021-04-27 update: The solution now works over CMG. Please see this post for details.
If you haven&amp;rsquo;t seen my first blog post about modern driver management, the quick summary is that the solution uses packages created with the Driver Automation Tool and the administration service to retrieve information on these packages and identify the most suitable driver package to apply in a task sequence.
In this second part, I&amp;rsquo;ll be discussing the changes and improvements done to the existing solution to also dynamically retrieve and filter and apply BIOS updates.</description></item><item><title>Create Windows 10 Kiosk Environment</title><link>https://sysmansquad.com/2020/06/16/create-windows-10-kiosk-environment/</link><pubDate>Tue, 16 Jun 2020 14:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/06/16/create-windows-10-kiosk-environment/</guid><description>Recently I had case where a we had to deploy computers that required Kiosk mode. Trouble was, I couldn&amp;rsquo;t run Windows Kiosk mode for the auto start of the application I wanted the Kiosk users to operate.
I discovered these registry settings to allow me to functionally create a Kiosk environment.
These registry edits will result in the following:
Any time the user logs into this computer. The chosen application will launch.</description></item><item><title>Build a ConfigrMgr lab with AutomatedLab</title><link>https://sysmansquad.com/2020/06/15/build-a-configrmgr-lab-with-automatedlab/</link><pubDate>Mon, 15 Jun 2020 06:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/06/15/build-a-configrmgr-lab-with-automatedlab/</guid><description>In this post I&amp;rsquo;ll show you how to start building a ConfigMgr lab, for either Current Branch or Technical Preview, using AutomatedLab with Hyper-V. This approach is intended to be completely automated and &amp;ldquo;hands off&amp;rdquo; by calling a single script.
It downloads all the necessary files for you, including the CB or TP installation media. All you have to do is provide a Windows Server 2016/2019 ISO, but this can also be an evaluation copy.</description></item><item><title>Working With Internet-Optimized Task Sequences and Generic Status Messages</title><link>https://sysmansquad.com/2020/06/10/working-with-internet-optimized-task-sequences-and-generic-status-messages/</link><pubDate>Wed, 10 Jun 2020 14:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/06/10/working-with-internet-optimized-task-sequences-and-generic-status-messages/</guid><description>For my customer the move to remote work is here to stay. In adjustment to the “New Normal,” deployment projects put on hold these last months are in discussion again. One project resuming soon is the upgrade from Office 2016 to Microsoft 365 Apps. With many laptop computers now internet or VPN-based what can be done to optimize upgrades for these remote users?
To provide background, my customer has recently implemented cloud management gateways and cloud distribution points.</description></item><item><title>Deploy languages via Software Center with PSCMWin10Language</title><link>https://sysmansquad.com/2020/06/08/deploy-languages-via-software-center-with-pscmwin10language/</link><pubDate>Mon, 08 Jun 2020 15:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/06/08/deploy-languages-via-software-center-with-pscmwin10language/</guid><description>This post complements my other post, where I walk-through the differences of LP, LIP, LXP and FoD.
Here I will show you how to use a PowerShell module I wrote, PSCMWin10Languages, to create Microsoft Endpoint Manager Configuration Manager Applications for each language you want to deploy via the Software Center.
These Applications are not for OSD. It changes the language only for the user who installs the Application via the Software Center.</description></item><item><title>Language Packs, Language Experience Packs, Language Interface Packs… what?!</title><link>https://sysmansquad.com/2020/06/08/language-packs-language-experience-packs-language-interface-packs-what/</link><pubDate>Mon, 08 Jun 2020 15:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/06/08/language-packs-language-experience-packs-language-interface-packs-what/</guid><description>For a while I have been curious on how to do Windows OSD with multiple languages &amp;ldquo;the proper way&amp;rdquo; using Configuration Manager. Whenever I have approached the subject I have always felt overwhelmed.
Googling the topic is just a hot mess. You&amp;rsquo;re faced with information that&amp;rsquo;s old, lacking real detail or generally misunderstood. My aim here is to demystify the topic and show you a solid way to do Windows 10 multi language OSD with ConfigMgr along with sound reasoning.</description></item><item><title>Modern Driver Management with the Administration Service</title><link>https://sysmansquad.com/2020/05/15/modern-driver-management-with-the-administration-service/</link><pubDate>Fri, 15 May 2020 14:39:20 +0000</pubDate><guid>https://sysmansquad.com/2020/05/15/modern-driver-management-with-the-administration-service/</guid><description>2021-04-27 update: The solution now works over CMG. Please see this post for details.
Hello!
Today I’d like to share with you a new solution I’ve developed to allow me to use the free Modern Driver Management solution from the team at MSEndpointMgr at my work. My goal is to use the process developed by them for managing drivers in a task sequence and convert it to use the ConfigMgr Administration Service since my company won&amp;rsquo;t allow me to install their third-party web service.</description></item><item><title>Teams Channel Notification when OSD Fails</title><link>https://sysmansquad.com/2020/04/22/teams-channel-notification-when-osd-fails/</link><pubDate>Wed, 22 Apr 2020 13:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/04/22/teams-channel-notification-when-osd-fails/</guid><description>How would you like this lovely notification appearing within MS Teams every time a build failed? Better than getting a helpdesk ticket or not finding out at all.
Well, now you can!
Removed broken screenshot - editor
Step 1 - Configure Teams You need to make sure your O365 Administrator has enabled Incoming webhooks connectors in your O365 Tenant.
Open Teams. Select a channel, or create a new channel specific for these notifications (This is best practice so normal channels are not spammed) Click the &amp;hellip; Next to the channel name and choose Connectors Removed broken screenshot - editor</description></item><item><title>Collect Client Logs – The Fast Channel Way</title><link>https://sysmansquad.com/2020/04/08/collect-client-logs-the-fast-channel-way/</link><pubDate>Wed, 08 Apr 2020 13:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/04/08/collect-client-logs-the-fast-channel-way/</guid><description>What&amp;rsquo;s New? Starting in MEMCM 2002 there is an incredible new tool in the Client Notification tool bag. Client log collection!
This is a vital addition to the console. At first glance I thought&amp;hellip;
But then the features full value was realized!
Collecting Logs Over CMG Scenario: Increasing remote workforce, no VPN, but that nifty CMG thing is in place. What does that imply? There is no SMB access to the client.</description></item><item><title>Inventory Deprovisioned Windows 10 Apps</title><link>https://sysmansquad.com/2020/03/11/inventory-deprovisioned-windows-10-apps/</link><pubDate>Wed, 11 Mar 2020 14:00:00 +0000</pubDate><guid>https://sysmansquad.com/2020/03/11/inventory-deprovisioned-windows-10-apps/</guid><description>In my previous post I&amp;rsquo;ve shown that we can revert the deprovisioning of Windows 10 apps. This is awesome news for anyone that has removed the Windows Store. I have been unable to find any other way of restoring the Windows Store once it has been deprovisioned, so this is an awesome time saver. Instead of reimaging devices that do not have the store we can simply &amp;lsquo;reprovision&amp;rsquo; the store, and perform a feature update!</description></item><item><title>Managing Multiple Office 365 Deployments with ConfigMgr</title><link>https://sysmansquad.com/2021/02/25/managing-multiple-office-365-deployments-with-configmgr/</link><pubDate>Tue, 25 Feb 2020 17:36:48 +0000</pubDate><guid>https://sysmansquad.com/2021/02/25/managing-multiple-office-365-deployments-with-configmgr/</guid><description>At the client I&amp;rsquo;m currently working for, we have FIVE different deployments of Office 365 Client within Microsoft Enterprise Configuration Manager. The business decided that they only wanted users to have exactly what was needed. Essentially, this is the legacy approach to Office deployment in the MSI days where you could fully customise which components were installed and was easy to add bits back in at a later date.
These are the options they wanted:</description></item><item><title>To Trust Or Not To Trust (UNSIGNED DRIVERS): That Is The Question</title><link>https://sysmansquad.com/2021/02/04/to-trust-or-not-to-trust-unsigned-drivers-that-is-the-question/</link><pubDate>Tue, 04 Feb 2020 06:48:24 +0000</pubDate><guid>https://sysmansquad.com/2021/02/04/to-trust-or-not-to-trust-unsigned-drivers-that-is-the-question/</guid><description>This post is intended to help others who might want to better understand why their Operating System Deployment (OSD) task sequence (TS) is failing during the Setup Windows and Configuration Manager step with an error code of 0x80004005 and how to identify the unsigned drivers in your driver package that might be causing it. Maybe my google-fu was failing me, but I didn&amp;rsquo;t see anything else out there that was a guided tour with pictures through the old Microsoft article on this issue.</description></item><item><title>Intune/Autopilot Setup Companion Guide Part 2 – Windows Store for Business</title><link>https://sysmansquad.com/2021/01/27/intune-autopilot-setup-companion-guide-part-2-windows-store-for-business/</link><pubDate>Mon, 27 Jan 2020 19:15:59 +0000</pubDate><guid>https://sysmansquad.com/2021/01/27/intune-autopilot-setup-companion-guide-part-2-windows-store-for-business/</guid><description>Purpose The following blog posts will be a companion guide to Steve and Adam’s Intune training videos found at Intune.Training (this covers Episode 3) and will help you get the Windows Store for Business (WSfB, also known as Microsoft Store for Business) setup in your environment. This guide assumes that you already have followed Part 1 of this series and already have a working deployment profile. By the end of this guide you will have access to the Company Portal app and other apps of your choosing.</description></item><item><title>Windows Virtual Desktop: Creation and Management</title><link>https://sysmansquad.com/2021/01/13/wvd-creation-and-management/</link><pubDate>Mon, 13 Jan 2020 06:33:53 +0000</pubDate><guid>https://sysmansquad.com/2021/01/13/wvd-creation-and-management/</guid><description>THIS GUIDE IS NOW OUTDATED WITH THE RELEASE OF WVD 2.0, I will create a new blog with the updated info in the future! Some of the info below is still valid! Why Windows Virtual Desktop? Windows Virtual Desktop allows you to create virtual Windows 10 machines that can be accessed from virtually anywhere. This means you can give someone a full desktop experience from virtually anywhere including android and iOS!</description></item><item><title>Reprovision Windows 10 Apps… Wait, What?</title><link>https://sysmansquad.com/2021/01/06/reprovision-windows-10-apps-wait-what/</link><pubDate>Mon, 06 Jan 2020 13:54:48 +0000</pubDate><guid>https://sysmansquad.com/2021/01/06/reprovision-windows-10-apps-wait-what/</guid><description>Remember when we all complained that Microsoft &amp;ldquo;wasn&amp;rsquo;t respecting our app removals!&amp;rdquo; and they were all reinstalled during every feature update? Pepperidge farm remembers. Well, Microsoft was kind enough to hear our collective complaints, and take action on them. That is an awesome quality that we are seeing from the product teams at Microsoft.
Starting in Windows 10 1803, deprovisioned apps will NOT be reinstalled during a feature update. No more Solitaire returning from the dead every time we try to &amp;ldquo;Get current and stay current.</description></item><item><title>Intune/Autopilot Setup Companion Guide Part 1</title><link>https://sysmansquad.com/2019/12/18/autopilot-setup-part-1/</link><pubDate>Wed, 18 Dec 2019 14:50:37 +0000</pubDate><guid>https://sysmansquad.com/2019/12/18/autopilot-setup-part-1/</guid><description>Purpose The following blog posts will be a companion guide to Steve and Adam&amp;rsquo;s Intune training videos found at Intune.Training (this covers Episode 1 and 2) and will help you get Autopilot going in your environment. This guide assumes that you already have office 365 and azure configured. By the end of this guide you will have a working bare bones Autopilot configuration. This has been a major request from several people in the WinAdmins community.</description></item></channel></rss>